function whenDOMReady(){console.log("pjax开启"),musicState()}function percent(){let a=document.documentElement.scrollTop||window.pageYOffset,b=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,result=Math.round(a/b*100),btn;result<=99||(result=99),document.querySelector("#percent").innerHTML=result}window.onscroll=percent,document.getElementById("page-name").innerText=document.title.split(" | 参星阁")[0];var logo=document.createElement("img"),site=document.getElementById("site-info"),title=document.getElementById("site-title");function musicState(){const music_state=document.querySelector("meting-js").aplayer.audio.paused;music_state?(document.querySelector("#music-Switch i").classList.remove("fa-pause"),document.querySelector("#music-Switch i").classList.add("fa-play"),document.querySelector("#console #music-ctrl-btn-center i").classList.remove("fa-pause"),document.querySelector("#console #music-ctrl-btn-center i").classList.add("fa-play")):(document.querySelector("#music-Switch i").classList.remove("fa-play"),document.querySelector("#music-Switch i").classList.add("fa-pause"),document.querySelector("#console #music-ctrl-btn-center i").classList.remove("fa-play"),document.querySelector("#console #music-ctrl-btn-center i").classList.add("fa-pause"))}function secToTime(s){isNaN(s)&&(s=0);var min=Math.floor(s/60),sec=Math.floor(s%60),t;return min.toString().padStart(2,"0")+":"+sec.toString().padStart(2,"0")}logo.style="position:relative;left:calc(50% - 75px);width:150px;height:150px",logo.src="https://i.imgtg.com/2023/02/06/0Su3b.png",site.insertBefore(logo,title),site.style.top="30%";var ctrl={switchDarkMode:function(){const nowMode="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===nowMode?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid()},showConsole:function(){document.querySelector("#console").classList.add("show"),ctrl.initConsoleState()},hideConsole:function(){document.querySelector("#console").classList.remove("show")},consoleBackBtn:function(){var top_item=document.querySelector(".item-show");switch(top_item.id){case"#console-music-item-mini":break;case"console-music-item-main":ctrl.hideConsole();break;case"console-music-item-list":case"console-music-item-lrc":top_item.classList.remove("item-show"),document.getElementById("console-music-item-main").classList.add("item-show");break;default:console.log("异常情况")}},ircShowHide:function(){const irc=document.querySelector(".aplayer > .aplayer-lrc-hide");null===irc?(document.querySelector(".aplayer > .aplayer-lrc").classList.add("aplayer-lrc-hide"),document.querySelector("#ircItem").classList.remove("on")):(document.querySelector(".aplayer > .aplayer-lrc").classList.remove("aplayer-lrc-hide"),document.querySelector("#ircItem").classList.add("on"))},hideAsideBtn:()=>{const $htmlDom=document.documentElement.classList;$htmlDom.contains("hide-aside")?(saveToLocal.set("aside-status","show",2),document.querySelector("#asideItem").classList.remove("on")):(saveToLocal.set("aside-status","hide",2),document.querySelector("#asideItem").classList.add("on")),$htmlDom.toggle("hide-aside")},settingsOpen:function(){alert("开发中...敬请期待！")},musicSwitch:function(){const music_state=document.querySelector("meting-js").aplayer.audio.paused;music_state?(document.querySelector("#music-Switch i").classList.remove("fa-play"),document.querySelector("#music-Switch i").classList.add("fa-pause"),document.querySelector("#console #music-ctrl-btn-center i").classList.remove("fa-play"),document.querySelector("#console #music-ctrl-btn-center i").classList.add("fa-pause")):(document.querySelector("#music-Switch i").classList.remove("fa-pause"),document.querySelector("#music-Switch i").classList.add("fa-play"),document.querySelector("#console #music-ctrl-btn-center i").classList.remove("fa-pause"),document.querySelector("#console #music-ctrl-btn-center i").classList.add("fa-play")),document.querySelector("meting-js").aplayer.toggle()},musicForward:function(){document.querySelector("meting-js").aplayer.skipForward()},musicBackward:function(){document.querySelector("meting-js").aplayer.skipBack()},getMusicInfo:function(){var music_id=document.querySelector("meting-js").aplayer.list.index,music_cover=document.querySelector("meting-js").aplayer.list.audios[music_id].cover,music_author=document.querySelector("meting-js").aplayer.list.audios[music_id].author,music_title=document.querySelector("meting-js").aplayer.list.audios[music_id].title;document.getElementById("console-music-cover").innerHTML="<img src='"+music_cover+"' style='width:100%;height:100%;border-radius:0.5rem;'>",document.getElementById("console-music-title").innerHTML=music_title,document.getElementById("console-music-author").innerHTML=music_author;var nowTime=document.querySelector("meting-js").aplayer.audio.currentTime;isNaN(nowTime)&&(nowTime=0);var nowTimeString=secToTime(nowTime),allTime=document.querySelector("meting-js").aplayer.audio.duration;isNaN(allTime)&&(allTime=0);var allTimeString=secToTime(allTime);document.getElementById("progress-low-btn").innerHTML=nowTimeString,document.getElementById("progress-high-btn").innerHTML=allTimeString,document.querySelector("#p_bar").style.width=document.querySelector("#p_bar_bg").offsetWidth*(nowTime/allTime)+"px"},initConsoleState:function(){const irc=document.querySelector(".aplayer > .aplayer-lrc-hide"),aplayer=document.querySelector(".aplayer > .aplayer-lrc");null===irc&&null!=aplayer?document.querySelector("#ircItem").classList.add("on"):document.querySelector("#ircItem").classList.remove("on"),"hide"===saveToLocal.get("aside-status")?document.querySelector("#asideItem").classList.add("on"):document.querySelector("#asideItem").classList.remove("on");var console_musicBody=document.querySelector("#console .console-music-ctrl-item"),console_musicCover=document.getElementById("console-music-cover");console_musicCover.style.height=console_musicCover.offsetWidth+"px",console_musicBody.style.height=console_musicCover.offsetWidth+240+"px";var nowVolume=document.querySelector("meting-js").aplayer.audio.volume;document.querySelector("#v_bar").style.width=document.querySelector("#v_bar_bg").offsetWidth*nowVolume+"px"}},console_music_list=document.getElementById("console-music-list"),music_id=null;function importMusicList(){for(var audios=document.querySelector("meting-js").aplayer.list.audios,list_html,i=0;i<audios.length;i++)list_html=document.getElementById("console-music-list").innerHTML,document.getElementById("console-music-list").innerHTML=list_html+"<li class='music-list-item'><div class='list-music-info1'><a class='list-music-id' data-pjax-state=''>"+(i+1)+"</a><a class='list-music-state' data-pjax-state=''><i class='iconfont icon-waveform'></i></a></div><div class='list-music-info2'><a class='list-music-title' data-pjax-state=''>"+audios[i].title+"</a><a class='list-music-author' data-pjax-state=''> - "+audios[i].author+"</a></div></li>",console.log("第"+(i+1)+"首导入成功！")}console_music_list.addEventListener("click",(function(e){var ap=document.querySelector("meting-js").aplayer;e.target&&"LI"==e.target.nodeName.toUpperCase()?(music_id=parseInt(id_obj.innerHTML),ap.list.switch(music_id-1),ap.play()):e.target&&"DIV"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.parentElement.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play()):!e.target||"A"!=e.target.nodeName.toUpperCase()&&"I"!=e.target.nodeName.toUpperCase()?alert("ERROR!"):(music_id=parseInt(e.target.parentElement.parentElement.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play())}),!1);var music_volumebar=document.getElementById("music-volumebar"),v_bar_bg=document.getElementById("v_bar_bg"),v_bar=document.getElementById("v_bar"),v_low=document.getElementById("volume-low-btn"),v_high=document.getElementById("volume-high-btn"),v_bar_bg_Len=v_bar_bg.offsetWidth;music_volumebar.addEventListener("mousedown",(function(e){v_bar_bg.style.height="0.6rem",v_bar.style.backgroundColor="var(--anzhiyu-reverse)",v_low.style.color="var(--anzhiyu-reverse)",v_high.style.color="var(--anzhiyu-reverse)";let x=e.pageX;v_bar.style.width=0+e.offsetX+"px";let v_bar_Len=v_bar.offsetWidth;v_bar_bg_Len=v_bar_bg.offsetWidth;let newVolume=e.offsetX/v_bar_bg_Len;document.querySelector("meting-js").aplayer.volume(newVolume,!0),document.onmousemove=function(e){let diff=x-e.pageX,v_bar_Len_New=v_bar_Len-diff;v_bar_Len_New<0?v_bar_Len_New=0:v_bar_Len_New>v_bar_bg_Len&&(v_bar_Len_New=v_bar_bg_Len),v_bar.style.width=v_bar_Len_New+"px",newVolume=v_bar_Len_New/v_bar_bg_Len,document.querySelector("meting-js").aplayer.volume(newVolume,!0)}})),music_volumebar.addEventListener("touchstart",(function(e){v_bar_bg.style.height="0.6rem",v_bar.style.backgroundColor="var(--anzhiyu-reverse)",v_low.style.color="var(--anzhiyu-reverse)",v_high.style.color="var(--anzhiyu-reverse)";let x=e.targetTouches[0].pageX;v_bar.style.width=0+e.targetTouches[0].offsetX+"px";let v_bar_Len=v_bar.offsetWidth;v_bar_bg_Len=v_bar_bg.offsetWidth;let newVolume=e.targetTouches[0].offsetX/v_bar_bg_Len;document.querySelector("meting-js").aplayer.volume(newVolume,!0),document.ontouchmove=function(e){let diff=x-e.targetTouches[0].pageX,v_bar_Len_New=v_bar_Len-diff;v_bar_Len_New<0?v_bar_Len_New=0:v_bar_Len_New>v_bar_bg_Len&&(v_bar_Len_New=v_bar_bg_Len),v_bar.style.width=v_bar_Len_New+"px",newVolume=v_bar_Len_New/v_bar_bg_Len,document.querySelector("meting-js").aplayer.volume(newVolume,!0)}}));var music_progressbar=document.getElementById("music-progressbar"),p_bar_bg=document.getElementById("p_bar_bg"),p_bar=document.getElementById("p_bar"),p_low=document.getElementById("progress-low-btn"),p_high=document.getElementById("progress-high-btn"),p_bar_Len_New=0,p_bar_bg_Len=p_bar_bg.offsetWidth,ctrl_flag=1,mousemove_flag=1;music_progressbar.addEventListener("mousedown",(function(e){p_bar_bg.style.height="0.6rem",p_bar.style.backgroundColor="var(--anzhiyu-reverse)",p_low.style.color="var(--anzhiyu-reverse)",p_high.style.color="var(--anzhiyu-reverse)",ctrl_flag=0,global_music_flag=1;let x=e.pageX,p_bar_Len=p_bar.offsetWidth;p_bar_bg_Len=p_bar_bg.offsetWidth,document.onmousemove=function(e){let diff=x-e.pageX;mousemove_flag=0,(p_bar_Len_New=p_bar_Len-diff)<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.width=p_bar_Len_New+"px";let all_Time=document.querySelector("meting-js").aplayer.audio.duration,current_time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.getElementById("progress-low-btn").innerHTML=secToTime(current_time)}})),music_progressbar.addEventListener("touchstart",(function(e){p_bar_bg.style.height="0.6rem",p_bar.style.backgroundColor="var(--anzhiyu-reverse)",p_low.style.color="var(--anzhiyu-reverse)",p_high.style.color="var(--anzhiyu-reverse)",ctrl_flag=0,global_music_flag=1;let x=e.targetTouches[0].pageX,p_bar_Len=p_bar.offsetWidth;p_bar_bg_Len=p_bar_bg.offsetWidth,document.ontouchmove=function(e){let diff=x-e.targetTouches[0].pageX;mousemove_flag=0,(p_bar_Len_New=p_bar_Len-diff)<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.width=p_bar_Len_New+"px";let all_Time=document.querySelector("meting-js").aplayer.audio.duration,current_time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.getElementById("progress-low-btn").innerHTML=secToTime(current_time)}})),document.onmouseup=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let all_Time=document.querySelector("meting-js").aplayer.audio.duration,new_Time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.querySelector("meting-js").aplayer.seek(new_Time)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.onmousemove=null},document.ontouchend=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let all_Time=document.querySelector("meting-js").aplayer.audio.duration,new_Time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.querySelector("meting-js").aplayer.seek(new_Time)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.ontouchmove=null};var music_list_switch=document.getElementById("music-ctrl-btn-end");function owoBig(){let flag=1,owo_time="",m=3,div=document.createElement("div"),body=document.querySelector("body"),observer;div.id="owo-big",body.appendChild(div),new MutationObserver(mutations=>{for(let i=0;i<mutations.length;i++){let dom=mutations[i].addedNodes,owo_body="";2==dom.length&&"OwO-body"==dom[1].className&&(owo_body=dom[1],document.body.clientWidth<=768&&owo_body.addEventListener("contextmenu",e=>e.preventDefault()),owo_body.onmouseover=e=>{flag&&"IMG"==e.target.tagName&&(flag=0,owo_time=setTimeout(()=>{let height=3*e.path[0].clientHeight,width=3*e.path[0].clientWidth,left=e.x-e.offsetX-(width-e.path[0].clientWidth)/2,top=e.y-e.offsetY;left+width>body.clientWidth&&(left-=left+width-body.clientWidth+10),left<0&&(left=10),div.style.cssText=`display:flex; height:${height}px; width:${width}px; left:${left}px; top:${top}px;`,div.innerHTML=`<img src="${e.target.src}">`},300))},owo_body.onmouseout=()=>{div.style.display="none",flag=1,clearTimeout(owo_time)})}}).observe(document.getElementById("post-comment"),{subtree:!0,childList:!0})}function colorHex(str){var reg=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,that=str;if(/^(rgb|RGB)/.test(that)){for(var aColor=that.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),strHex="#",i=0;i<aColor.length;i++){var hex=Number(aColor[i]).toString(16);"0"===hex&&(hex+=hex),strHex+=hex}return 7!==strHex.length&&(strHex=that),strHex}if(!reg.test(that))return that;var aNum=that.replace(/#/,"").split("");if(6===aNum.length)return that;if(3===aNum.length){for(var numHex="#",i=0;i<aNum.length;i+=1)numHex+=aNum[i]+aNum[i];return numHex}}function colorRgb(str){var reg=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,sColor=str.toLowerCase();if(sColor&&reg.test(sColor)){if(4===sColor.length){for(var sColorNew="#",i=1;i<4;i+=1)sColorNew+=sColor.slice(i,i+1).concat(sColor.slice(i,i+1));sColor=sColorNew}for(var sColorChange=[],i=1;i<7;i+=2)sColorChange.push(parseInt("0x"+sColor.slice(i,i+2)));return"rgb("+sColorChange.join(",")+")"}return sColor}function RandomColor(){this.r=Math.floor(255*Math.random()),this.g=Math.floor(255*Math.random()),this.b=Math.floor(255*Math.random()),this.color="rgba("+this.r+","+this.g+","+this.b+",0.8)"}music_list_switch.addEventListener("click",(function(e){document.getElementById("console-music-item-main").classList.remove("item-show"),document.getElementById("console-music-item-list").classList.add("item-show")})),whenDOMReady(),document.addEventListener("pjax:complete",whenDOMReady),document.getElementById("post-comment")&&owoBig();