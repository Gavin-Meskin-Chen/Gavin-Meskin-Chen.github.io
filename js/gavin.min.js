function percent(){let e=document.documentElement.scrollTop||window.pageYOffset,t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,o=Math.round(e/t*100),n=document.getElementById("percent");o<=99||(o=99),n.innerHTML=o}function cardTimes(){year=now.getFullYear(),month=now.getMonth(),week=now.getDay(),date=now.getDate(),hours=now.getHours();var e=document.getElementById("card-widget-calendar");if(e){var t=year%4==0&&year%100!=0||year%400==0;switch(week){case 0:weekStr="周日";break;case 1:weekStr="周一";break;case 2:weekStr="周二";break;case 3:weekStr="周三";break;case 4:weekStr="周四";break;case 5:weekStr="周五";break;case 6:weekStr="周六";break;default:console.log("异常情况")}switch(month){case 0:monthStr="1月",dates=31;break;case 1:monthStr="2月",dates=t?29:28;break;case 2:monthStr="3月",dates=31;break;case 3:monthStr="4月",dates=30;break;case 4:monthStr="5月",dates=31;break;case 5:monthStr="6月",dates=30;break;case 6:monthStr="7月",dates=31;break;case 7:monthStr="8月",dates=31;break;case 8:monthStr="9月",dates=30;break;case 9:monthStr="10月",dates=31;break;case 10:monthStr="11月",dates=30;break;case 11:monthStr="12月",dates=31;break;default:console.log("异常情况")}var o,n=(week+8-date%7)%7,s="",a=!1,r=7-n,c=(dates-r)%7,i=0==c?Math.floor((dates-r)/7)+1:Math.floor((dates-r)/7)+2,l=e.querySelector("#calendar-main"),d=e.querySelector("#calendar-date");switch(i){case 4:d.style.fontSize="36px";break;case 5:d.style.fontSize="48px";break;case 6:d.style.fontSize="64px";break;default:d.style.fontSize="64px"}for(let e=0;e<i;e++){null==l.querySelector(".calendar-r"+e)&&(l.innerHTML+="<div class='calendar-r"+e+"'></div>");for(let t=0;t<7;t++)0==e&&t==n&&(s=1,a=!0),o=s==date?" class='now'":"",null==l.querySelector(".calendar-r"+e+" .calendar-d"+t+" a")&&(l.querySelector(".calendar-r"+e).innerHTML+="<div class='calendar-d"+t+"'><a"+o+">"+s+"</a></div>"),s>=dates&&(s="",a=!1),a&&(s+=1)}var m=chineseLunar.solarToLunar(new Date(year,month,date));animalYear=chineseLunar.format(m,"A"),ganzhiYear=chineseLunar.format(m,"T").slice(0,-1),lunarMon=chineseLunar.format(m,"M"),lunarDay=chineseLunar.format(m,"d");const h=(new Date).getFullYear();var u=new Date(h+"/12/20 08:30:00"),g=Math.floor((u-now)/1e3/60/60/24);asideTime=new Date(h+"/01/01 00:00:00"),asideDay=(now-asideTime)/1e3/60/60/24,asideDayNum=Math.floor(asideDay);var p=week-asideDayNum%7>=0?Math.ceil(asideDayNum/7):Math.ceil(asideDayNum/7)+1;e.querySelector("#calendar-week").innerHTML="第"+p+"周&nbsp;"+weekStr,e.querySelector("#calendar-date").innerHTML=date.toString().padStart(2,"0"),e.querySelector("#calendar-solar").innerHTML=year+"年"+monthStr+"&nbsp;第"+asideDay.toFixed(0)+"天",e.querySelector("#calendar-lunar").innerHTML=ganzhiYear+animalYear+"年&nbsp;"+lunarMon+lunarDay,document.getElementById("schedule-days").innerHTML=g}}function asideNote(){var e=document.querySelector(".card-widget.card-announcement");if(e){var t=document.querySelector(".card-widget.card-announcement .announcement_content");if(date==dates)e.style.display="",t.innerHTML="<p align='center'>今天月末，做好总结</p>";else if(1==date)e.style.display="",t.innerHTML="<p align='center'>今天月初，做好规划</p>";else switch(lunarDay){case"十六":e.style.display="",t.innerHTML="<p align='center'>今晚月圆</p>";break;default:e.style.display="none"}}}function categoryBarMask(){var e=document.getElementById("category-bar-items"),t=Math.ceil(e.scrollLeft),o=Math.ceil(e.clientWidth),n=Math.ceil(e.scrollWidth);0==t&&n<=o?e.style.webkitMaskImage="":0==t&&n>o?e.style.webkitMaskImage="linear-gradient(-90deg,transparent,#fff 20px)":t>0&&t+o<n?e.style.webkitMaskImage="linear-gradient(90deg,transparent,#fff 20px,#fff calc(100% - 20px),transparent)":t>0&&t+o>=n&&(e.style.webkitMaskImage="linear-gradient(90deg,transparent,#fff 20px)"),e.addEventListener("scroll",categoryBarMask)}function categoriesBarActive(){document.getElementById("category-bar")&&document.querySelector(".category-bar-item").classList.remove("select");var e=window.location.pathname;if(e=decodeURIComponent(e),"/"==e)document.getElementById("category-bar")&&document.getElementById("首页").classList.add("select");else{var t=/\/categories\/.*?\//,o=t.test(e);if(o){var n=e.split("/"),s=n[2];document.getElementById("category-bar")&&document.getElementById(s).classList.add("select")}}}function tagsBarActive(){if(document.getElementById("tag-bar-items")){var e=window.location.pathname;e=decodeURIComponent(e);var t=e.split("/"),o=t[2];console.log(o),document.getElementById(o).classList.add("select")}}function tagsBarActive_0(){var e=window.location.pathname;if(e=decodeURIComponent(e),"/"==e)document.querySelector("#tags-bar")&&document.getElementById("首页").classList.add("select");else{var t=/\/tags\/.*?\//,o=t.test(e);if(o){var n=e.split("/"),s=n[2];document.querySelector("#category-bar")&&document.getElementById(s).classList.add("select")}}}function topCategoriesBarScroll(){if(document.getElementById("category-bar-items")){let e=document.getElementById("category-bar-items");e.addEventListener("mousewheel",function(t){let o=-t.wheelDelta/2;e.scrollLeft+=o,t.preventDefault()},!1)}}document.addEventListener("DOMContentLoaded",()=>{console.log("第一次加载完成"),document.getElementById("page-name").innerText=document.title.split(" | 参星阁")[0],cardTimes(),asideNote(),cardRefreshTimes(),percent(),tools.getIp(),ctrl.toPageJump(),ctrl.getCurrentPage(),ctrl.refreshLikeCount(),ctrl.coverFlow(),0!=document.documentElement.scrollTop&&document.getElementById("page-header").classList.add("is-top-bar"),document.getElementById("post-comment")&&ctrl.owoBig(),(set_fps.checked||"true"===localStorage.getItem("fps_state"))&&(tools.updateFPS(),document.getElementById("fps-box").style.display="flex"),ctrl.setupMediaSessionHandlers(document.querySelector(".global-music").aplayer)}),document.addEventListener("pjax:complete",()=>{console.log("pjax加载完成（切换页面）"),document.getElementById("page-name").innerText=document.title.split(" | 参星阁")[0],cardTimes(),asideNote(),cardRefreshTimes(),ctrl.toPageJump(),ctrl.getCurrentPage(),ctrl.refreshLikeCount(),ctrl.coverFlow(),0!=document.documentElement.scrollTop&&document.getElementById("page-header").classList.add("is-top-bar"),document.getElementById("post-comment")&&ctrl.owoBig(),document.getElementById("category-bar-items")&&(categoriesBarActive(),categoryBarMask()),tagsBarActive(),ctrl.musicState(),(set_fps.checked||"true"===localStorage.getItem("fps_state"))&&(document.getElementById("fps-box").style.display="flex")});const marqueeContainer1=document.getElementById("console-music-title"),marqueeContent1=document.getElementById("console-music-title-text"),marqueeContainer2=document.getElementById("console-music-author"),marqueeContent2=document.getElementById("console-music-author-text");var userInfo,ipAddress="",frameCount=0,startTime=performance.now();let animationId;var winbox="";"paintWorklet"in CSS&&CSS.paintWorklet.addModule(CDNURL+"/js/paint.min.js"),window.onload=function(){function e(){var e=document.createElement("link");e.id="dodododooocss",e.rel="stylesheet",e.type="text/css",e.href="https://dodododooo.com/mplayer2/remote/css/app-mplayer.css";var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e);var o=document.createElement("script");o.id="dodododooojs",o.type="text/javascript",o.src="https://dodododooo.com/mplayer2/remote/js/app-mplayer.js",document.body.appendChild(o)}function t(){var e=document.getElementById("dodododooocss");e&&document.head.removeChild(e);var t=document.getElementById("dodododooojs");t&&document.body.removeChild(t);var o=document.getElementById("mplayer");o&&document.body.removeChild(o)}var o=document.querySelector("#set-switch-music input");if(o.checked&&e(),o.addEventListener("change",()=>{o.checked?e():t()}),null!=localStorage.getItem("notice_state")&&(set_notice.checked="true"==localStorage.getItem("notice_state")),null!=localStorage.getItem("fps_state")&&(set_fps.checked="true"==localStorage.getItem("fps_state")),null!=localStorage.getItem("scroll_state")&&(set_scroll.checked="true"==localStorage.getItem("scroll_state")),null!=localStorage.getItem("lrc_state")&&"true"==localStorage.getItem("lrc_state")&&document.getElementById("lrcSwitchBtn").click(),null!=localStorage.getItem("system_theme_state")&&(set_sys_theme.checked="true"==localStorage.getItem("system_theme_state")),null!=localStorage.getItem("theme-color")&&ctrl.changeThemeColor(localStorage.getItem("theme-color")),null!=localStorage.getItem("aside-direction")&&"right"==localStorage.getItem("aside-direction")&&ctrl.asideContentDirection(),set_sys_theme.checked){const e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=window.matchMedia("(prefers-color-scheme: light)").matches;t?(activateLightMode(),document.querySelector("#set-theme-light input").checked=!0,saveToLocal.set("theme","light",2)):e&&(activateDarkMode(),document.querySelector("#set-theme-dark input").checked=!0,saveToLocal.set("theme","dark",2)),colorSchemeQuery.addListener(ctrl.GlobalTheme)}null!=saveToLocal.get("theme")&&("light"==saveToLocal.get("theme")?document.querySelector("#set-theme-light input").checked=!0:document.querySelector("#set-theme-dark input").checked=!0),console.log("\n %c GC音频控制器 v1.3.2 参星阁出品 %c https://blog.cancin.cn \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),console.log(`Welcome to:\n%c参星阁:%c https://blog.cancin.cn%c\nThis site has been running stably for %c${Math.round(((new Date).getTime()-new Date("2023/01/04 20:53:58").getTime())/864e5)} %c days`,"border:1px #888 solid;border-right:0;border-radius:5px 0 0 5px;padding: 5px 10px;color:white;background:#4976f5;margin:10px 0","border:1px #888 solid;border-left:0;border-radius:0 5px 5px 0;padding: 5px 10px;","","color:#4976f5","")},window.onscroll=percent;var tools={secToTime(e){isNaN(e)&&(e=0);var t=Math.floor(e/60),o=Math.floor(e%60),n=t.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0");return n},detectBrowser(){const e=navigator.userAgent;let t,o,n,s,a=e.substring(e.indexOf("(")+1,e.indexOf(")")).toLowerCase();-1!=a.indexOf("hmscore")||-1!=a.indexOf("huawei")||-1!=a.indexOf("harmonyos")?s="HarmonyOS设备":-1!=a.indexOf("windows")?s="PC":-1!=a.indexOf("iphone")?s="iPhone":-1!=a.indexOf("ipad")?s="iPad":-1!=a.indexOf("macintosh")?s="Mac":-1!=a.indexOf("android")?s="Android":-1!=a.indexOf("cros")?s="ChromeOS设备":-1!=a.indexOf("playstation")?s="PlayStation":-1!=a.indexOf("symbian")?s="Symbian":-1!=a.indexOf("linux")&&(s="Linux");let r=e.toLowerCase();return/firefox[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Firefox",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/edge[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/edg[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/edga[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/edgios[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Edge",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/hbpc[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/huaweibrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="HUAWEI Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/miuibrowser[\/\s](\d+\.\d+\.\d+)/.test(r)?(t="MIUI Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/vivobrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="vivo Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/heytapbrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="OPPO Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/baiduboxapp[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/baidubrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Baidu Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/ucbrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/ubrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="UC Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/quark[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Quark Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/mqqbrowser[\/\s](\d+\.\d+\.\d+)/.test(r)||/mqqbrowser[\/\s](\d+\.\d+)/.test(r)||/qqbrowser[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="QQ Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/micromessenger[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Wechat Browser",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/opr[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Opera",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/crios[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)||/chrome[\/\s](\d+\.\d+\.\d+\.\d+)/.test(r)?(t="Chrome",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/safari[\/\s](\d+\.\d+\.\d+)/.test(r)||/safari[\/\s](\d+\.\d+)/.test(r)?(/version[\/\s](\d+\.\d+)/.test(r),t="Safari",o=RegExp.$1,n=parseInt(RegExp.$1,10)):/msie (\d+\.\d+);/.test(r)||/trident[\/\s](\d+\.\d+)/.test(r)?(t="Internet Explorer",o=RegExp.$1,n=parseInt(RegExp.$1,10)):(t="Unknown",o="Unknown",n=0),{name:t,version:o,majorVersion:n,hard:s}},getOSInfo(){let e="unknown",t="unknown",o=navigator.userAgent;return-1!=o.indexOf("Windows")?(e="Windows",-1!=o.indexOf("Windows NT 10.0")?t="10":-1!=o.indexOf("Windows NT 6.3")?t="8.1":-1!=o.indexOf("Windows NT 6.2")?t="8":-1!=o.indexOf("Windows NT 6.1")?t="7":-1!=o.indexOf("Windows NT 6.0")?t="Vista":-1!=o.indexOf("Windows NT 5.1")?t="XP":-1!=o.indexOf("Windows NT 5.0")&&(t="2000")):-1!=o.indexOf("iPhone OS")?(e="iOS",t=o.match(/OS\s([\d_]+)/)[1].replace(/_/g,".")):-1!=o.indexOf("iPad")?(e="iPadOS",t=o.match(/CPU OS\s([\d_]+)/)[1].replace(/_/g,".")):-1!=o.indexOf("Mac OS X")?(e="macOS",t=o.match(/Mac OS X\s([\d_]+)/)[1].replace(/_/g,".")):(-1==o.indexOf("Android 10")||-1==o.toLowerCase().indexOf("huawei")&&-1==o.indexOf("HarmonyOS")&&-1==o.indexOf("HMSCore"))&&(-1==o.indexOf("Android 11")||-1==o.toLowerCase().indexOf("huawei")&&-1==o.indexOf("HarmonyOS")&&-1==o.indexOf("HMSCore"))?-1==o.indexOf("Android 12")||-1==o.toLowerCase().indexOf("huawei")&&-1==o.indexOf("HarmonyOS")&&-1==o.indexOf("HMSCore")?-1!=navigator.userAgent.indexOf("Android")?(e="Android",t=navigator.userAgent.match(/Android\s([\d.]+)/)[1]):-1!=navigator.userAgent.indexOf("Linux")&&(e="Linux"):(e="HarmonyOS",t=4):(e="HarmonyOS",t=3),{name:e,version:t}},getMemoryUsage(){const e=performance.memory,t=e.totalJSHeapSize/1048576,o=e.usedJSHeapSize/1048576,n=e.jsHeapSizeLimit/1048576;return console.log(`Total memory: ${t.toFixed(2)} MB`),console.log(`Used memory: ${o.toFixed(2)} MB`),console.log(`Memory limit: ${n.toFixed(2)} MB`),{totalM:t.toFixed(2),usedM:o.toFixed(2),limitM:n.toFixed(2)}},getBatteryInfo(){"getBattery"in navigator&&navigator.getBattery().then(function(e){return console.log("Battery level: "+100*e.level+"%"),console.log("Battery state: "+e.charging),{level:e.level,state:e.charging}})},getIp(){null==localStorage.getItem("ipAddress")?fetch(ipAPI).then(e=>e.json()).then(e=>{ipAddress=e.ip,localStorage.setItem("ipAddress",ipAddress),console.log("您的 IP 地址："+ipAddress)}).catch(e=>{console.error("获取 IP 地址失败:",e)}):ipAddress=localStorage.getItem("ipAddress")},showNote(e,t,o){new Vue({data:function(){this.$notify({title:"阁主令",message:e,position:"top-left",showClose:!0,customClass:"element-note-bg-"+t,type:t,duration:1e3*o})}})},showMessage(e,t,o){new Vue({data:function(){this.$message({message:e,showClose:!0,type:t,duration:1e3*o})}})},updateFPS(){frameCount++;var e=performance.now(),t=e-startTime;if(t>=1e3){var o=Math.round(1e3*frameCount/t);document.querySelector("#fps-box .fps-text").textContent=o,frameCount=0,startTime=e}animationId=requestAnimationFrame(tools.updateFPS)},randomColor(){var e=["rgba(0,150,255,.95)","rgba(0,255,150,.95)","rgba(255,150,0,.95)","rgba(255,0,150,.95)","rgba(150,255,0,.95)","rgba(150,0,255,.95)"],t=Math.floor(6*Math.random());return e[t]}},ctrl={GlobalTheme(e){console.log(`changed to ${e.matches?"dark":"light"} mode`),e.matches?(activateDarkMode(),document.querySelector("#set-theme-dark input").checked=!0,saveToLocal.set("theme","dark",2)):(activateLightMode(),document.querySelector("#set-theme-light input").checked=!0,saveToLocal.set("theme","light",2))},switchDarkMode(){const e="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===e?document.getElementById("set-theme-dark").click():document.getElementById("set-theme-light").click(),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid()},showConsole(){document.getElementById("console-music-item-main").classList.add("item-show"),document.getElementById("console").classList.add("show"),set_scroll.checked&&"false"!==localStorage.getItem("scroll_state")||(document.body.style.overflow="hidden"),ctrl.initConsoleState()},hideConsole(){var e=document.querySelectorAll(".item-show");for(let t=0;t<e.length;t++)e[t].classList.remove("item-show");document.getElementById("console").classList.remove("show"),document.body.style.overflow=""},consoleBackBtn(){var e=document.querySelectorAll(".item-show");if(e.length>0)if(1==e.length)switch(e[0].id){case"console-music-item-mini":break;case"console-music-item-main":ctrl.hideConsole();break;case"console-music-item-list":e[0].classList.remove("item-show"),document.getElementById("console-music-item-main").classList.add("item-show");break;case"console-songsheet-item-list":e[0].classList.remove("item-show"),document.getElementById("console-music-item-list").classList.add("item-show");break;default:console.log("异常情况")}else e[e.length-1].classList.remove("item-show")},lrcShowHide(){var e=document.querySelector(".global-music .aplayer-lrc"),t=document.getElementById("lrcItem");e&&t&&(e.classList.contains("aplayer-lrc-hide")?(e.classList.remove("aplayer-lrc-hide"),t.classList.add("on"),localStorage.setItem("lrc_state",!0),set_notice.checked&&tools.showMessage("桌面歌词已打开","success",2)):(e.classList.add("aplayer-lrc-hide"),t.classList.remove("on"),localStorage.setItem("lrc_state",!1),set_notice.checked&&tools.showMessage("桌面歌词已关闭","success",2)))},hideAsideBtn(){const e=document.documentElement.classList;e.contains("hide-aside")?(saveToLocal.set("aside-status","show",2),document.getElementById("asideItem").classList.remove("on"),set_notice.checked&&tools.showMessage("侧边栏已启用","success",2)):(saveToLocal.set("aside-status","hide",2),document.getElementById("asideItem").classList.add("on"),set_notice.checked&&tools.showMessage("侧边栏已隐藏","success",2)),e.toggle("hide-aside")},settingsOpen(){alert("开发中...敬请期待！")},musicSwitch(){var e=document.querySelector(".global-music").aplayer.audio.paused,t=document.querySelector("#music-Switch i"),o=document.querySelector("#music-ctrl-btn-center i");e?(t.classList.remove("icon-play"),t.classList.add("icon-pause"),o.classList.remove("icon-play"),o.classList.add("icon-pause")):(t.classList.remove("icon-pause"),t.classList.add("icon-play"),o.classList.remove("icon-pause"),o.classList.add("icon-play")),document.querySelector(".global-music").aplayer.toggle()},musicForward(){document.querySelector(".global-music").aplayer.skipForward(),ctrl.getMusicInfo()},musicBackward(){document.querySelector(".global-music").aplayer.skipBack(),ctrl.getMusicInfo()},getMusicInfo(){var e=document.querySelector(".global-music").aplayer.list.index,t=document.querySelector(".global-music").aplayer.list.audios[e].cover,o=document.querySelector(".global-music").aplayer.list.audios[e].author,n=document.querySelector(".global-music").aplayer.list.audios[e].title;document.getElementById("console-music-cover").innerHTML="<img src='"+t+"'>",document.querySelector("#console-music-item-main .cover-shadow").style.background="url('"+t+"') center center / 100% 100% no-repeat",document.getElementById("console-music-title-text").innerHTML=n,document.getElementById("console-music-author-text").innerHTML=o,ctrl.marqueeMusicInfo()},refreshProgress(){var e=document.querySelector(".global-music").aplayer.audio.currentTime;isNaN(e)&&(e=0);var t=tools.secToTime(e),o=document.querySelector(".global-music").aplayer.audio.duration;isNaN(o)&&(o=0);var n=tools.secToTime(o);document.getElementById("progress-low-btn").innerHTML=t,document.getElementById("progress-high-btn").innerHTML=n,document.getElementById("p_bar").style.transform="translateX(-"+100*(1-e/o)+"%)"},importMusicList(){var e,t=document.querySelector(".global-music").aplayer.list.audios;for(let o=0;o<t.length;o++)e=document.getElementById("console-music-list").innerHTML,document.getElementById("console-music-list").innerHTML=e+"<li class='music-list-item'><div class='list-music-info1'><a class='list-music-id' data-pjax-state=''>"+(o+1)+"</a><a class='list-music-state' data-pjax-state=''><i class='blogfont icon-waveform'></i></a></div><div class='list-music-info2'><a class='list-music-title' data-pjax-state=''>"+t[o].name+"</a><a class='list-music-author' data-pjax-state=''>&nbsp;-&nbsp;"+t[o].artist+"</a></div></li>"},changeMusicList(e,t){var o=document.querySelector(".global-music").aplayer,n="https://metingjs.cancin.cn/api?server="+t+"&type=playlist&id="+e;o.list.clear(),fetch(n).then(e=>e.json()).then(e=>{newSongsheetLen=e.length,console.log("本专辑有"+newSongsheetLen+"首歌曲"),o.list.add(e)}).catch(e=>console.error(e))},JayMusicList(){var e=document.querySelector(".global-music").aplayer;e.list.clear(),console.log("本专辑有"+JaySongsheet.length+"首歌曲"),e.list.add(JaySongsheet)},JokerMusicList(){var e=document.querySelector(".global-music").aplayer;e.list.clear(),console.log("本专辑有"+QianSongsheet.length+"首歌曲"),e.list.add(QianSongsheet)},musicState(){var e=document.querySelector(".global-music").aplayer.audio.paused,t=document.querySelector("#music-Switch i"),o=document.querySelector("#music-ctrl-btn-center i");e?(t.classList.remove("icon-pause"),t.classList.add("icon-play"),o.classList.remove("icon-pause"),o.classList.add("icon-play")):(t.classList.remove("icon-play"),t.classList.add("icon-pause"),o.classList.remove("icon-play"),o.classList.add("icon-pause"))},clearConsoleMusicList(){document.getElementById("console-music-list").innerHTML=""},addMusicToList(e,t,o,n,s){var a=document.querySelector(".global-music").aplayer;ctrl.clearConsoleMusicList(),a.list.add([{title:e,author:t,url:o,pic:n,lrc:s}]),a.list.switch(a.list.audios.length-1)},mcToggleMusic(e,t){const o=document.getElementById(e);if(o){const e=o.querySelector(".content");if(!e.classList.contains("canplay")){const n=o.querySelector(".audio");n.src=t,n.addEventListener("loadeddata",function t(){e.classList.add("canplay"),n.removeEventListener("loadeddata",t)})}const n=o.querySelector(".audio");n.paused?n.play():n.pause()}},mcRefreshTime(e){var t=document.getElementById(e);if(t){var o=t.querySelector(".audio"),n=o.currentTime+.5,s=o.duration,a=tools.secToTime(n),r=tools.secToTime(s);t.querySelector(".time").innerHTML=`${a}&nbsp;/&nbsp;${r}`,t.querySelector(".mc-progressbar").style.transform="translateX(-"+100*(1-n/s)+"%)"}},setMediaMetadata:function(e,t){const o=e.list.audios[e.list.index],n=o.cover||"./img/avatar.webp",s=document.querySelector(".global-music").querySelector(".aplayer-lrc-current").textContent;let a,r;"mediaSession"in navigator?(t&&s?(a=s,r=`${o.artist} | ${o.name}`):(a=o.name,r=o.artist),navigator.mediaSession.metadata=new MediaMetadata({title:a,artist:r,album:o.album,artwork:[{src:n,sizes:"96x96",type:"image/jpeg"},{src:n,sizes:"128x128",type:"image/jpeg"},{src:n,sizes:"192x192",type:"image/jpeg"},{src:n,sizes:"256x256",type:"image/jpeg"},{src:n,sizes:"384x384",type:"image/jpeg"},{src:n,sizes:"512x512",type:"image/jpeg"}]})):(console.log("当前浏览器不支持 Media Session API"),document.title=`${o.name} - ${o.artist}`)},setupMediaSessionHandlers:function(e){"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",()=>{e.play()}),navigator.mediaSession.setActionHandler("pause",()=>{e.pause()}),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",()=>{e.skipBack()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{e.skipForward()}),navigator.mediaSession.setActionHandler("seekto",t=>{t.fastSeek&&"fastSeek"in e.audio?e.audio.fastSeek(t.seekTime):e.audio.currentTime=t.seekTime}),e.on("loadeddata",()=>{ctrl.setMediaMetadata(e,!1)}),e.on("play",()=>{"mediaSession"in navigator&&(navigator.mediaSession.playbackState="playing",ctrl.setMediaMetadata(e,!0))}),e.on("pause",()=>{"mediaSession"in navigator&&(navigator.mediaSession.playbackState="paused",ctrl.setMediaMetadata(e,!1))}),e.on("timeupdate",()=>{ctrl.setMediaMetadata(e,!0)}))},marqueeMusicInfo(){if(marqueeContent1.offsetWidth>marqueeContainer1.offsetWidth){var e=marqueeContent1.offsetWidth/marqueeContainer1.offsetWidth*6;marqueeContent1.style.animation="marquee-1 "+e+"s linear infinite"}else marqueeContent1.style.animation="";if(marqueeContent2.offsetWidth>marqueeContainer2.offsetWidth){e=marqueeContent2.offsetWidth/marqueeContainer2.offsetWidth*6;marqueeContent2.style.animation="marquee-1 "+e+"s linear infinite"}else marqueeContent2.style.animation=""},initConsoleState(){var e=document.querySelector(".aplayer > .aplayer-lrc-hide"),t=document.querySelector(".aplayer > .aplayer-lrc");null===e&&null!=t?document.getElementById("lrcItem").classList.add("on"):document.getElementById("lrcItem").classList.remove("on"),"hide"===saveToLocal.get("aside-status")?document.getElementById("asideItem").classList.add("on"):document.getElementById("asideItem").classList.remove("on"),ctrl.getMusicInfo();var o=document.querySelector(".global-music").aplayer.audio.volume;document.getElementById("v_bar").style.transform="translateX(-"+100*(1-o)+"%)","light"==saveToLocal.get("theme")?document.querySelector("#set-theme-light input").checked=!0:document.querySelector("#set-theme-dark input").checked=!0},refreshThemeColor(){var e=document.getElementById("page-header");if(e){var t=e.style.backgroundImage.slice(5,-2)+"?x-oss-process=image/average-hue";fetch(t).then(e=>e.json()).then(e=>{var t="#"+e.RGB.slice(2);console.log("主色调为："+t),document.documentElement.style.setProperty("--gavin-main-color",t)}).catch(e=>console.error(e))}},sidebarItemsFold(){let e=document.querySelectorAll("#sidebar-menus .menus_items .site-page.group");e&&e.forEach(t=>{t.addEventListener("click",()=>{e.forEach(e=>{e!=t&&e.classList.add("hide")})})})},toPageJump(){function e(e){for(var t=window.location.pathname,o=[],n=-1;-1!==(n=t.indexOf("/",n+1));)o.push(n);var s=o.length;if(1==s||"page"==t.substring(1,o[s-2]))return["/#content-inner",`/page/${e}/#content-inner`];if(s>=4&&"page"==t.substring(o[s-3]+1,o[s-2])){var a=t.substring(0,o[s-3]+1);return[`${a}`,`${a}page/${e}/`]}return[`${t}`,`${t}page/${e}/`]}let t=document.querySelector("#pagination input.toPageInput");t&&(t.addEventListener("input",()=>{let e=document.querySelectorAll(".page-number"),o=e[e.length-1].innerHTML;Number(t.value)>o&&(t.value=o),Number(t.value)<1&&(t.value="")}),t.addEventListener("keyup",o=>{("Enter"==o.key||13==o.keyCode)&&""!=t.value&&"0"!=t.value&&pjax.loadUrl("1"==t.value?e(t.value)[0]:e(t.value)[1])}))},getCurrentPage(){if(window.innerWidth<=768&&(document.getElementById("recent-posts")||document.getElementById("tag")||document.getElementById("category")||document.getElementById("archive"))){var e=document.querySelector(".pagination .page-number.current").innerHTML;if(e){var t=document.querySelector(".pagination .toPageInput");t&&(t.placeholder="第 "+e+" 页")}}},scrollCategoryBarToRight(){function e(){o.style.transform=Math.ceil(t.scrollLeft)+Math.ceil(t.clientWidth)>=Math.ceil(t.scrollWidth)?"rotate(180deg)":""}var t=document.getElementById("category-bar-items"),o=document.querySelector(".category-bar-more");t.addEventListener("scroll",e);var n=Math.ceil(t.clientWidth);t&&(Math.ceil(t.scrollLeft)+Math.ceil(t.clientWidth)>=Math.ceil(t.scrollWidth)?(t.scroll({left:0,behavior:"smooth"}),o.style.transform="",t.removeEventListener("scroll",e)):(t.scrollBy({left:n,behavior:"smooth"}),o.style.transform=""))},scrollTagBarToEnd(){var e=document.getElementById("tag-bar-items"),t=document.querySelector(".tag-bar-more i");"rotate(180deg)"==t.style.transform?(e.style.maxHeight=window.innerWidth<=768?"105px":"32px",t.style.transform=""):(e.style.maxHeight="calc(100vh - 155px)",t.style.transform="rotate(180deg)")},scrollBackground(){const e=window.location.pathname;if("/"==e||/^\/page\/\d+\/$/.test(e)){const e=window.innerHeight-80,t=window.scrollY,o=t/e>1?1:t/e;document.getElementById("body-wrap").style.background=`rgba(var(--gavin-bg),${o})`}else document.getElementById("body-wrap").style.background="var(--gavin-background)"},refreshLikeCount(){var e=window.location.pathname,t=e.substring(1,5);if("post"==t){var o=e.substring(6,14);fetch(`https://apis.cancin.cn/likecount?mode=get&id=${o}`).then(e=>e.json()).then(e=>{if(200==e.code){var t=e.content[0].count;document.querySelector(".post-reward .like-button .like-count").innerText=t}else console.log(e.message)}).catch(e=>{console.error("获取点赞信息失败:",e)})}},sendArticleLike(){var e=document.querySelector(".post-reward .like-button");if(!e.classList.contains("loading")){var t=window.location.pathname.substring(6,14);e.classList.add("loading"),fetch(`https://apis.cancin.cn/likecount?mode=add&id=${t}&ip=${ipAddress}`).then(e=>e.json()).then(t=>{if(200==t.code){var o=t.content[0].count;e.querySelector(".like-count").innerText=o,e.classList.remove("loading"),tools.showMessage("感谢您的认可！","success",2)}else 205==t.code?(e.classList.remove("loading"),tools.showMessage(t.message,"warning",2)):(e.classList.remove("loading"),console.log(t.message),tools.showMessage(t.message,"error",2))}).catch(t=>{console.error("获取点赞信息失败:",t),e.classList.remove("loading")})}},getLocationWeather(){fetch("https://api.ipify.org?format=json").then(e=>e.json()).then(e=>{ipAddress=e.ip,console.log("IP 地址："+ipAddress),fetch("https://apis.cancin.cn/weather?ip="+ipAddress+"&output=jsonp").then(e=>e.json()).then(e=>{console.log(e);e.weatherJson.daily[0],e.weatherJson.daily[1],e.weatherJson.daily[2],e.locationJson.result.ad_info.district,e.locationJson.result.ad_info.city,e.locationJson.result.ad_info.province}).catch(e=>{console.error("获取天气信息失败:",e)})}).catch(e=>{console.error("获取 IP 地址失败:",e)})},toggleSocial(){document.querySelector(".author-info-social .social-icons").classList.toggle("show")},owoBig(){let e=1,t="",o=3,n=document.createElement("div"),s=document.querySelector("body");n.id="owo-big",s.appendChild(n);let a=new MutationObserver(a=>{for(let r=0;r<a.length;r++){let c=a[r].addedNodes,i="";2==c.length&&"OwO-body"==c[1].className&&(i=c[1],document.body.clientWidth<=768&&i.addEventListener("contextmenu",e=>e.preventDefault()),i.onmouseover=(a=>{e&&"IMG"==a.target.tagName&&(e=0,t=setTimeout(()=>{let e=a.target.clientHeight*o,t=a.target.clientWidth*o,r=a.x-a.offsetX-(t-a.target.clientWidth)/2,c=a.y-a.offsetY;r+t>s.clientWidth&&(r-=r+t-s.clientWidth+10),r<0&&(r=10),n.style.cssText=`display:flex; height:${e}px; width:${t}px; left:${r}px; top:${c}px;`,n.innerHTML=`<img src="${a.target.src}">`},300))}),i.onmouseout=(()=>{n.style.display="none",e=1,clearTimeout(t)}))}});a.observe(document.getElementById("post-comment"),{subtree:!0,childList:!0})},coverFlow(){var e=window.location.pathname,t="/"!=e?e.match(/\/([^/]+)\//)[1]:"";if("movies"==t){var o=document.getElementById("head-cover"),n=o.querySelector(".head-cover-img");n.style.objectPosition||(n.style.objectPosition="calc(50% - 75px) center"),n.style.filter||(n.style.filter="dark"===document.documentElement.getAttribute("data-theme")?"blur(1.5px) brightness(0.7)":"blur(1.5px)"),n.style.transform||(n.style.transform="rotate(-15deg) scale(2)"),n.style.animation||(n.style.animation="coverFlow 30s infinite linear")}else if("about"==t){n=document.querySelector("#head-cover .head-cover-img");n.style.objectPosition||(n.style.objectPosition="center 20%")}else"link"==t&&document.querySelector("#post-comment .comment-head").insertAdjacentHTML("beforeend",'<a class="apply-for-flink" onclick="ctrl.applyForFlink()">申请友链</a>')},applyForFlink(){var e=document.querySelector("#twikoo .tk-comments > .tk-submit .el-textarea textarea");e.value="```YML\n- name: \n  link: \n  avatar: \n  descr: \n  siteshot: \n```",e.style.height="159px"},
commentQuote(e){document.querySelector("#twikoo .tk-comments > .tk-submit .el-textarea textarea").value=e,document.getElementById("twikoo").scrollIntoView({behavior:"smooth"})},changeThemeColor(e){var t=[["0,100,255","0,150,255"],["129,78,250","0,234,208"],["66,90,239","255,190,0"]],o=document.querySelector(".setting-right .checked");o&&o.classList.remove("checked"),document.querySelector(".setting-right .theme-color-"+e).classList.add("checked"),document.documentElement.style.setProperty("--gavin-theme-color-light",t[e-1][0]),document.documentElement.style.setProperty("--gavin-theme-color-dark",t[e-1][1]),localStorage.setItem("theme-color",e)},asideContentDirection(){var e=document.getElementById("asideContentDirection");if(e)document.head.removeChild(e),document.querySelector("#set-aside-direction .label-active").style.left="3px",document.querySelector("#set-aside-direction .right").classList.remove("active"),document.querySelector("#set-aside-direction .left").classList.add("active"),localStorage.setItem("aside-direction","left");else{var t=document.createElement("style");t.type="text/css",t.id="asideContentDirection",t.innerHTML="#aside-content{order:2;}",document.head.appendChild(t),document.querySelector("#set-aside-direction .label-active").style.left="48px",document.querySelector("#set-aside-direction .left").classList.remove("active"),document.querySelector("#set-aside-direction .right").classList.add("active"),localStorage.setItem("aside-direction","right")}},jsDebug(event){function a(){var code=document.getElementById("jsDebugInput").value;try{var result=eval(code);document.getElementById("jsDebugOutput").value=result}catch(e){document.getElementById("jsDebugOutput").value="运行出错："+e}}"Enter"!==event.key||event.shiftKey||(event.preventDefault(),a())},showAPPs(){document.getElementById("apps").classList.add("show"),set_scroll.checked&&"false"!==localStorage.getItem("scroll_state")||(document.body.style.overflow="hidden")},hideAPPs(){document.getElementById("apps").classList.remove("show"),document.body.style.overflow=""},toggleWinbox(e){document.getElementById("winboxForApps")?winbox.toggleClass("hide"):ctrl.createWinboxForApps(e)},resizeWinbox(){let e=document.getElementById("winboxForApps");if(e&&!e.classList.contains("min")&&!e.classList.contains("max")){var t=document.documentElement.clientWidth;t<=768?winbox.resize(.95*t+"px","80%").move("center","center"):winbox.resize(.6*t+"px","70%").move("center","center")}},createWinboxForApps(e){var t="",o="",n="";switch(e){case"encryption":t="参星阁 - 加密工具",o="encryption",n='\n                    <div class="select-items">\n                        <select class="select-item type">\n                            <option class="opt" value="MD5">MD5</option>\n                            <option class="opt" value="SHA1">SHA1</option>\n                            <option class="opt" value="SHA3">SHA3</option>\n                            <option class="opt" value="SHA224">SHA224</option>\n                            <option class="opt" value="SHA256">SHA256</option>\n                            <option class="opt" value="SHA384">SHA384</option>\n                            <option class="opt" value="SHA512">SHA512</option>\n                            <option class="opt" value="RIPEMD160">RIPEMD160</option>\n                            <option class="opt" value="AESEncode">AES加密</option>\n                            <option class="opt" value="AESDecode">AES解密</option>\n                        </select>\n                        <select class="select-item code">\n                            <option class="opt" value="Hex">Hex</option>\n                            <option class="opt" value="Base64">Base64</option>\n                        </select>\n                        <select class="select-item case">\n                            <option class="opt" value="Lower">小写</option>\n                            <option class="opt" value="Upper">大写</option>\n                        </select>\n                        <select class="select-item mode hide">\n                            <option class="opt" value="CBC">CBC</option>\n                            <option class="opt" value="CFB">CFB</option>\n                            <option class="opt" value="CTR">CTR</option>\n                            <option class="opt" value="OFB">OFB</option>\n                            <option class="opt" value="ECB">ECB</option>\n                        </select>\n                        <select class="select-item pad hide">\n                            <option class="opt" value="Pkcs7">Pkcs7</option>\n                            <option class="opt" value="Iso97971">Iso97971</option>\n                            <option class="opt" value="Iso10126">Iso10126</option>\n                            <option class="opt" value="AnsiX923">AnsiX923</option>\n                            <option class="opt" value="ZeroPadding">ZeroPadding</option>\n                            <option class="opt" value="NoPadding">NoPadding</option>\n                        </select>\n                        <input type="text" class="select-item key hide" placeholder="密钥">\n                        <input type="text" class="select-item iv hide" placeholder="偏移量">\n                    </div>\n                    <textarea autocomplete="off" rows="6" placeholder="请输入或者粘贴需要处理的文本" class="inner" style="min-height: 32.6px;"></textarea>\n                    <textarea autocomplete="off" rows="6" placeholder="处理结果" class="outer lock" style="min-height: 32.6px;" disabled="disabled"></textarea>\n                    <div class="btns">\n                        <button class="btn blue" type="button" onclick="transcode()">转码</button>\n                        <button class="btn green" type="button" onclick="copyTranscode()">复制</button>\n                        <button class="btn red" type="button" onclick="clearTranscode()">清空</button>\n                    </div>\n                    ',document.head.appendChild(Object.assign(document.createElement("script"),{src:"https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/crypto-js/4.1.1/crypto-js.min.js",id:"crypto-js"}));break;case"clipboard":t="参星阁 - 云剪贴板-Beta",o="clipboard",n='\n                <input type="text" class="select-item id" placeholder="请输入对接暗号">\n                <textarea autocomplete="off" rows="12" placeholder="发送/接收文本区域" style="min-height: 32.6px;"></textarea>\n                <div class="btns">\n                    <button class="btn blue" type="button" onclick="sendTextToClipboard()">我要发送</button>\n                    <button class="btn green" type="button" onclick="getTextFromClipboard()">我要接收</button>\n                </div>\n                ';break;default:t="参星阁 - App",o="",n="暂无应用程序"}let s=document.createElement("div");document.body.appendChild(s),winbox=WinBox({id:"winboxForApps",class:o,index:989,title:t,x:"center",y:"center",minwidth:"300px",height:"60%",background:"#29516C",onmaximize:()=>{s.innerHTML="<style>body::-webkit-scrollbar {display: none;}div#winboxForApps {width: 100% !important;}</style>"},onrestore:()=>{s.innerHTML=""}}),ctrl.resizeWinbox(),window.addEventListener("resize",ctrl.resizeWinbox),winbox.body.innerHTML=n,document.head.appendChild(Object.assign(document.createElement("script"),{src:CDNURL+"/js/"+o+".min.js",id:"appScript"})),document.querySelector(".wb-header .wb-close").addEventListener("click",()=>{var e=document.getElementById("appScript");e&&document.head.removeChild(e);var t=document.getElementById("crypto-js");t&&document.head.removeChild(t)}),ctrl.hideAPPs()}};document.getElementById("category-bar-items")&&(categoriesBarActive(),categoryBarMask()),tagsBarActive(),document.onkeydown=function(e){if(123==e.keyCode||e.ctrlKey&&e.shiftKey&&(74===e.keyCode||73===e.keyCode||67===e.keyCode)||e.ctrlKey&&85===e.keyCode)return tools.showNote("开发者模式已打开，请遵循GPL协议","warning",5)},document.addEventListener("copy",()=>{set_notice.checked&&tools.showMessage("复制成功！转载请注明来源！","success",2)});var set_notice=document.querySelector("#set-switch-notice input");set_notice.addEventListener("change",()=>{set_notice.checked?localStorage.setItem("notice_state",!0):localStorage.setItem("notice_state",!1)});var music_list_switch=document.getElementById("music-ctrl-btn-end"),music_list_title=document.getElementById("music-list-title"),settings_btn=document.querySelector("#console .settings-btn"),to_display=document.getElementById("li-set-display"),to_tools=document.getElementById("li-set-tools"),to_about=document.getElementById("li-set-about"),setting_info1=document.getElementById("console-setting-info1"),setting_title1=setting_info1.querySelector(".setting-title"),setting_info2=document.getElementById("console-setting-info2"),setting_title2=setting_info2.querySelector(".setting-title"),setting_info3=document.getElementById("console-setting-info3"),setting_title3=setting_info3.querySelector(".setting-title");music_list_switch.addEventListener("click",()=>{document.getElementById("console-music-item-list").classList.add("item-show")}),music_list_title.addEventListener("click",()=>{document.getElementById("console-songsheet-item-list").classList.add("item-show")}),settings_btn.addEventListener("click",()=>{document.getElementById("console-settings").classList.add("item-show")}),to_display.addEventListener("click",()=>{setting_title1.innerHTML="显示和文本",setting_info1.classList.add("item-show")}),to_about.addEventListener("click",()=>{setting_title2.innerHTML="关于本机",document.querySelector("#console-setting-info2 .set-box-normal:nth-child(3) .setting-detail").innerHTML=tools.detectBrowser().hard,document.querySelector("#console-setting-info2 .set-box-normal:nth-child(4) .setting-detail").innerHTML=tools.getOSInfo().name+" "+tools.getOSInfo().version,document.querySelector("#console-setting-info2 .set-box-normal:nth-child(5) .setting-detail").innerHTML=tools.detectBrowser().name+" "+tools.detectBrowser().version,setting_info2.classList.add("item-show")}),to_tools.addEventListener("click",()=>{setting_title3.innerHTML="辅助功能",setting_info3.classList.add("item-show")}),document.getElementById("set-theme-light").addEventListener("click",()=>{document.querySelector("#set-theme-light input").checked=!0,activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid(),set_notice.checked&&tools.showMessage("已切换至浅色模式","success",2)}),document.getElementById("set-theme-dark").addEventListener("click",()=>{document.querySelector("#set-theme-dark input").checked=!0,activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid(),set_notice.checked&&tools.showMessage("已切换至深色模式","success",2)});var set_sys_theme=document.querySelector("#set-switch-systheme input");set_sys_theme.addEventListener("change",()=>{if(set_sys_theme.checked){localStorage.setItem("system_theme_state",!0);const e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=window.matchMedia("(prefers-color-scheme: light)").matches;t?(activateLightMode(),document.querySelector("#set-theme-light input").checked=!0,saveToLocal.set("theme","light",2)):e&&(activateDarkMode(),document.querySelector("#set-theme-dark input").checked=!0,saveToLocal.set("theme","dark",2)),colorSchemeQuery.addListener(ctrl.GlobalTheme)}else localStorage.setItem("system_theme_state",!1),colorSchemeQuery.removeListener(ctrl.GlobalTheme)});var set_font_size=document.querySelector("#set-font-size input");set_font_size.addEventListener("change",()=>{document.documentElement.style.setProperty("--global-font-size",set_font_size.value+"px")});var set_scroll=document.querySelector("#set-switch-scroll input");set_scroll.addEventListener("change",()=>{set_scroll.checked?(localStorage.setItem("scroll_state",!0),set_notice.checked&&tools.showMessage("滚动条显示已打开","success",2)):(localStorage.setItem("scroll_state",!1),set_notice.checked&&tools.showMessage("滚动条显示已关闭","success",2))});var set_fps=document.querySelector("#set-switch-fps input");set_fps.addEventListener("change",()=>{set_fps.checked?(localStorage.setItem("fps_state",!0),tools.updateFPS(),document.getElementById("fps-box").style.display="flex",set_notice.checked&&tools.showMessage("实时帧率已打开","success",2)):(localStorage.setItem("fps_state",!1),cancelAnimationFrame(animationId),document.getElementById("fps-box").style.display="none",set_notice.checked&&tools.showMessage("实时帧率已关闭","success",2))}),document.getElementById("jsDebugInput").addEventListener("input",()=>{document.getElementById("jsDebugOutput").value=""});const songsheets=[{id:"songsheet-1",text:"<i class='blogfont icon-spinner'></i> 周杰伦",flag:1,func:()=>ctrl.JayMusicList()},{id:"songsheet-2",text:"<i class='blogfont icon-spinner'></i> 薛之谦/李荣浩",flag:1,func:()=>ctrl.JokerMusicList()},{id:"songsheet-3",text:"<i class='blogfont icon-spinner'></i> 纯音乐",flag:1,func:()=>ctrl.changeMusicList("8167030216","netease")},{id:"songsheet-4",text:"<i class='blogfont icon-spinner'></i> 外语",flag:1,func:()=>ctrl.changeMusicList("8658340188","netease")},{id:"songsheet-5",text:"<i class='blogfont icon-spinner'></i> 古风",flag:1,func:()=>ctrl.changeMusicList("8167066222","netease")},{id:"songsheet-6",text:"<i class='blogfont icon-spinner'></i> 默认歌单",flag:1,func:()=>ctrl.changeMusicList("8086610771","netease")}];songsheets.forEach((e,t)=>{const o=document.getElementById(e.id);o.addEventListener("click",()=>{document.getElementById("console-loading-icon").classList.add("show"),console.log(`正在切换至${e.text}专辑`),global_music_flag=e.flag,e.func(),document.getElementById("music-list-title").innerHTML=e.text,ctrl.consoleBackBtn()})});var addSongsheet=document.getElementById("songsheet-add");addSongsheet.addEventListener("click",()=>{console.log("自定义专辑"),set_notice.checked&&tools.showNote("有空再写吧","warning",3)});var console_music_list=document.getElementById("console-music-list"),music_id=null;console_music_list.addEventListener("click",function(e){var t=document.querySelector(".global-music").aplayer;e.target&&"LI"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.querySelector(".list-music-id").innerHTML),t.list.switch(music_id-1),t.play(),ctrl.getMusicInfo()):e.target&&"DIV"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.parentElement.querySelector(".list-music-id").innerHTML),t.list.switch(music_id-1),t.play(),ctrl.getMusicInfo()):!e.target||"A"!=e.target.nodeName.toUpperCase()&&"I"!=e.target.nodeName.toUpperCase()?alert("ERROR!"):(music_id=parseInt(e.target.parentElement.parentElement.querySelector(".list-music-id").innerHTML),t.list.switch(music_id-1),t.play(),ctrl.getMusicInfo())},!1);var music_volumebar=document.getElementById("music-volumebar"),v_bar_bg=document.getElementById("v_bar_bg"),v_bar=document.getElementById("v_bar"),v_low=document.getElementById("volume-low-btn"),v_high=document.getElementById("volume-high-btn"),v_bar_bg_Len=v_bar_bg.offsetWidth;music_volumebar.addEventListener("mousedown",function(e){v_bar_bg.style.height="0.8rem",v_bar.style.backgroundColor="var(--dis-f-0)",v_low.style.color="var(--dis-f-0)",v_high.style.color="var(--dis-f-0)";let t=e.clientX,o=v_bar.getBoundingClientRect().right-v_bar_bg.getBoundingClientRect().left;v_bar_bg_Len=v_bar_bg.offsetWidth;let n=(t-v_bar_bg.getBoundingClientRect().left)/v_bar_bg_Len;v_bar.style.transform="translateX(-"+100*(1-n)+"%)";const s=document.querySelector(".global-music");s.aplayer.volume(n,!0),document.onmousemove=function(e){let a=t-e.clientX,r=o-a;r<0?r=0:r>v_bar_bg_Len&&(r=v_bar_bg_Len),n=r/v_bar_bg_Len,v_bar.style.transform="translateX(-"+100*(1-n)+"%)",s.aplayer.volume(n,!0)}}),music_volumebar.addEventListener("touchstart",function(e){v_bar_bg.style.height="0.8rem",v_bar.style.backgroundColor="var(--dis-f-0)",v_low.style.color="var(--dis-f-0)",v_high.style.color="var(--dis-f-0)";let t=e.targetTouches[0].pageX,o=v_bar.getBoundingClientRect().right-v_bar_bg.getBoundingClientRect().left;v_bar_bg_Len=v_bar_bg.offsetWidth;let n=(t-v_bar_bg.getBoundingClientRect().left)/v_bar_bg_Len;v_bar.style.transform="translateX(-"+100*(1-n)+"%)";const s=document.querySelector(".global-music");s.aplayer.volume(n,!0),document.ontouchmove=function(e){let a=t-e.targetTouches[0].pageX,r=o-a;r<0?r=0:r>v_bar_bg_Len&&(r=v_bar_bg_Len),n=r/v_bar_bg_Len,v_bar.style.transform="translateX(-"+100*(1-n)+"%)",s.aplayer.volume(n,!0)}},{passive:!0});var music_progressbar=document.getElementById("music-progressbar"),p_bar_bg=document.getElementById("p_bar_bg"),p_bar=document.getElementById("p_bar"),p_low=document.getElementById("progress-low-btn"),p_high=document.getElementById("progress-high-btn"),p_bar_Len_New=0,p_bar_bg_Len=p_bar_bg.offsetWidth,ctrl_flag=1,mousemove_flag=1;music_progressbar.addEventListener("mousedown",function(e){p_bar_bg.style.height="0.8rem",p_bar.style.backgroundColor="var(--dis-f-0)",p_low.style.color="var(--dis-f-0)",p_high.style.color="var(--dis-f-0)",ctrl_flag=0,global_music_flag=1;let t=e.clientX,o=p_bar.getBoundingClientRect().right-p_bar_bg.getBoundingClientRect().left;p_bar_bg_Len=p_bar_bg.offsetWidth,document.onmousemove=function(e){let n=t-e.clientX;mousemove_flag=0,p_bar_Len_New=o-n,p_bar_Len_New<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.transform="translateX(-"+100*(1-p_bar_Len_New/p_bar_bg_Len)+"%)";let s=document.querySelector(".global-music").aplayer.audio.duration,a=p_bar_Len_New/p_bar_bg_Len*s;document.getElementById("progress-low-btn").innerHTML=tools.secToTime(a)}}),music_progressbar.addEventListener("touchstart",function(e){p_bar_bg.style.height="0.8rem",p_bar.style.backgroundColor="var(--dis-f-0)",p_low.style.color="var(--dis-f-0)",p_high.style.color="var(--dis-f-0)",ctrl_flag=0,global_music_flag=1;let t=e.targetTouches[0].pageX,o=p_bar.getBoundingClientRect().right-p_bar_bg.getBoundingClientRect().left;p_bar_bg_Len=p_bar_bg.offsetWidth,document.ontouchmove=function(e){let n=t-e.targetTouches[0].pageX;mousemove_flag=0,p_bar_Len_New=o-n,p_bar_Len_New<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.transform="translateX(-"+100*(1-p_bar_Len_New/p_bar_bg_Len)+"%)";let s=document.querySelector(".global-music").aplayer.audio.duration,a=p_bar_Len_New/p_bar_bg_Len*s;document.getElementById("progress-low-btn").innerHTML=tools.secToTime(a)}},{passive:!0}),document.onmouseup=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let e=document.querySelector(".global-music").aplayer.audio.duration,t=p_bar_Len_New/p_bar_bg_Len*e;document.querySelector(".global-music").aplayer.seek(t)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.onmousemove=null},document.ontouchend=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let e=document.querySelector(".global-music").aplayer.audio.duration,t=p_bar_Len_New/p_bar_bg_Len*e;document.querySelector(".global-music").aplayer.seek(t)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.ontouchmove=null};