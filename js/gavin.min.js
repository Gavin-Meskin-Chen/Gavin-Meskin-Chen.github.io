function whenDOMReady(){console.log("pjax开启"),musicState()}function percent(){let a=document.documentElement.scrollTop||window.pageYOffset,b=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,result=Math.round(a/b*100),btn;result<=99||(result=99),document.querySelector("#percent").innerHTML=result}window.onscroll=percent,document.getElementById("page-name").innerText=document.title.split(" | 参星阁")[0];var logo=document.createElement("img"),site=document.getElementById("site-info"),title=document.getElementById("site-title");function musicState(){var music_state=document.querySelector("meting-js").aplayer.audio.paused,a=document.querySelector("#music-Switch i"),b=document.querySelector("#music-ctrl-btn-center i");music_state?(a.classList.remove("fa-pause"),a.classList.add("fa-play"),b.classList.remove("fa-pause"),b.classList.add("fa-play")):(a.classList.remove("fa-play"),a.classList.add("fa-pause"),b.classList.remove("fa-play"),b.classList.add("fa-pause"))}logo.style="position:relative;left:calc(50% - 75px);width:150px;height:150px",logo.src="https://i.imgtg.com/2023/02/06/0Su3b.png",site.insertBefore(logo,title),site.style.top="30%";var tools={secToTime:function(s){isNaN(s)&&(s=0);var min=Math.floor(s/60),sec=Math.floor(s%60),t;return min.toString().padStart(2,"0")+":"+sec.toString().padStart(2,"0")},randomColor:function(){var colors,n;return["rgba(0,150,255,.95)","rgba(0,255,150,.95)","rgba(255,150,0,.95)","rgba(255,0,150,.95)","rgba(150,255,0,.95)","rgba(150,0,255,.95)"][Math.floor(6*Math.random())]}},ctrl={switchDarkMode:function(){const nowMode="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===nowMode?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid()},showConsole:function(){document.querySelector("#console-music-item-main").classList.add("item-show"),document.querySelector("#console").classList.add("show"),ctrl.initConsoleState()},hideConsole:function(){var items=document.querySelectorAll(".item-show");for(let i=0;i<items.length;i++)items[i].classList.remove("item-show");document.querySelector("#console").classList.remove("show")},consoleBackBtn:function(){var top_item=document.querySelector(".item-show");switch(top_item.id){case"console-music-item-mini":break;case"console-music-item-main":ctrl.hideConsole();break;case"console-music-item-list":top_item.classList.remove("item-show"),document.getElementById("console-music-item-main").classList.add("item-show");break;case"console-songsheet-item-list":top_item.classList.remove("item-show"),document.getElementById("console-music-item-list").classList.add("item-show");break;case"console-music-item-lrc":top_item.classList.remove("item-show"),document.getElementById("console-music-item-main").classList.add("item-show");break;default:console.log("异常情况")}},ircShowHide:function(){var irc=document.querySelector(".aplayer > .aplayer-lrc-hide"),a=document.querySelector(".aplayer > .aplayer-lrc"),b=document.querySelector("#ircItem");null===irc?(a.classList.add("aplayer-lrc-hide"),b.classList.remove("on")):(a.classList.remove("aplayer-lrc-hide"),b.classList.add("on"))},hideAsideBtn:()=>{const $htmlDom=document.documentElement.classList;$htmlDom.contains("hide-aside")?(saveToLocal.set("aside-status","show",2),document.querySelector("#asideItem").classList.remove("on")):(saveToLocal.set("aside-status","hide",2),document.querySelector("#asideItem").classList.add("on")),$htmlDom.toggle("hide-aside")},settingsOpen:function(){alert("开发中...敬请期待！")},musicSwitch:function(){var music_state=document.querySelector("meting-js").aplayer.audio.paused,a=document.querySelector("#music-Switch i"),b=document.querySelector("#music-ctrl-btn-center i");music_state?(a.classList.remove("fa-play"),a.classList.add("fa-pause"),b.classList.remove("fa-play"),b.classList.add("fa-pause")):(a.classList.remove("fa-pause"),a.classList.add("fa-play"),b.classList.remove("fa-pause"),b.classList.add("fa-play")),document.querySelector("meting-js").aplayer.toggle()},musicForward:function(){document.querySelector("meting-js").aplayer.skipForward(),ctrl.getMusicInfo()},musicBackward:function(){document.querySelector("meting-js").aplayer.skipBack(),ctrl.getMusicInfo()},getMusicInfo:function(){var music_id=document.querySelector("meting-js").aplayer.list.index,music_cover=document.querySelector("meting-js").aplayer.list.audios[music_id].cover,music_author=document.querySelector("meting-js").aplayer.list.audios[music_id].author,music_title=document.querySelector("meting-js").aplayer.list.audios[music_id].title;document.getElementById("console-music-cover").innerHTML="<img src='"+music_cover+"' style='width:100%;height:100%;border-radius:0.5rem;'>",document.getElementById("console-music-title").innerHTML=music_title,document.getElementById("console-music-author").innerHTML=music_author},refreshProgress:function(){var nowTime=document.querySelector("meting-js").aplayer.audio.currentTime;isNaN(nowTime)&&(nowTime=0);var nowTimeString=tools.secToTime(nowTime),allTime=document.querySelector("meting-js").aplayer.audio.duration;isNaN(allTime)&&(allTime=0);var allTimeString=tools.secToTime(allTime);document.getElementById("progress-low-btn").innerHTML=nowTimeString,document.getElementById("progress-high-btn").innerHTML=allTimeString,document.querySelector("#p_bar").style.width=document.querySelector("#p_bar_bg").offsetWidth*(nowTime/allTime)+"px"},importMusicList:function(){var audios=document.querySelector("meting-js").aplayer.list.audios,list_html;for(let i=0;i<audios.length;i++)list_html=document.getElementById("console-music-list").innerHTML,document.getElementById("console-music-list").innerHTML=list_html+"<li class='music-list-item'><div class='list-music-info1'><a class='list-music-id' data-pjax-state=''>"+(i+1)+"</a><a class='list-music-state' data-pjax-state=''><i class='iconfont icon-waveform'></i></a></div><div class='list-music-info2'><a class='list-music-title' data-pjax-state=''>"+audios[i].title+"</a><a class='list-music-author' data-pjax-state=''> - "+audios[i].author+"</a></div></li>"},changeMusicList:function(Music_id,Music_server){var ap=document.querySelector("meting-js").aplayer,music_list_url_str="https://metingjs.gavin-chen.top/api?server="+Music_server+"&type=playlist&id="+Music_id;ap.list.clear(),fetch(music_list_url_str).then(response=>response.json()).then(data=>{newSongsheetLen=data.length,console.log("本专辑有"+newSongsheetLen+"首歌曲"),ap.list.add(data)}).catch(error=>console.error(error))},JayMusicList:function(){var ap=document.querySelector("meting-js").aplayer;ap.list.clear(),ap.list.add(JaySongsheet)},initConsoleState:function(){var irc=document.querySelector(".aplayer > .aplayer-lrc-hide"),aplayer=document.querySelector(".aplayer > .aplayer-lrc");null===irc&&null!=aplayer?document.querySelector("#ircItem").classList.add("on"):document.querySelector("#ircItem").classList.remove("on"),"hide"===saveToLocal.get("aside-status")?document.querySelector("#asideItem").classList.add("on"):document.querySelector("#asideItem").classList.remove("on");var console_musicBody=document.querySelector("#console .console-music-ctrl-item"),console_musicCover=document.getElementById("console-music-cover");console_musicCover.style.height=console_musicCover.offsetWidth+"px",console_musicBody.style.height=console_musicCover.offsetWidth+236+"px",ctrl.getMusicInfo();var nowVolume=document.querySelector("meting-js").aplayer.audio.volume;document.querySelector("#v_bar").style.width=document.querySelector("#v_bar_bg").offsetWidth*nowVolume+"px"}},music_list_switch=document.getElementById("music-ctrl-btn-end"),music_list_title=document.getElementById("music-list-title");music_list_switch.addEventListener("click",(function(e){document.getElementById("console-music-item-main").classList.remove("item-show"),document.getElementById("console-music-item-list").classList.add("item-show")})),music_list_title.addEventListener("click",(function(e){document.getElementById("console-music-item-list").classList.remove("item-show"),document.getElementById("console-songsheet-item-list").classList.add("item-show")}));var songsheet0=document.getElementById("songsheet-X"),songsheet1=document.getElementById("songsheet-A"),songsheet2=document.getElementById("songsheet-B"),songsheet3=document.getElementById("songsheet-C"),songsheet4=document.getElementById("songsheet-D"),addSongsheet=document.getElementById("songsheet-add");songsheet0.addEventListener("click",(function(e){document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至默认专辑"),global_music_flag=1,ctrl.changeMusicList("8086610771","netease"),document.getElementById("music-list-title").innerHTML="网易云"})),songsheet1.addEventListener("click",(function(e){document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至纯音乐专辑"),global_music_flag=1,ctrl.changeMusicList("8167030216","netease"),document.getElementById("music-list-title").innerHTML="纯音乐"})),songsheet2.addEventListener("click",(function(e){document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至周杰伦专辑"),global_music_flag=1,ctrl.JayMusicList(),document.getElementById("music-list-title").innerHTML="周杰伦"})),songsheet3.addEventListener("click",(function(e){document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至薛之谦/李荣浩专辑"),global_music_flag=1,ctrl.changeMusicList("8163994837","netease"),document.getElementById("music-list-title").innerHTML="薛之谦/李荣浩"})),songsheet4.addEventListener("click",(function(e){document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至古风专辑"),global_music_flag=1,ctrl.changeMusicList("8167066222","netease"),document.getElementById("music-list-title").innerHTML="古风"})),addSongsheet.addEventListener("click",(function(e){console.log("自定义专辑"),alert("有空再写...")}));var console_music_list=document.getElementById("console-music-list"),music_id=null;console_music_list.addEventListener("click",(function(e){var ap=document.querySelector("meting-js").aplayer;e.target&&"LI"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play(),ctrl.getMusicInfo()):e.target&&"DIV"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.parentElement.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play(),ctrl.getMusicInfo()):!e.target||"A"!=e.target.nodeName.toUpperCase()&&"I"!=e.target.nodeName.toUpperCase()?alert("ERROR!"):(music_id=parseInt(e.target.parentElement.parentElement.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play(),ctrl.getMusicInfo())}),!1);var music_volumebar=document.getElementById("music-volumebar"),v_bar_bg=document.getElementById("v_bar_bg"),v_bar=document.getElementById("v_bar"),v_low=document.getElementById("volume-low-btn"),v_high=document.getElementById("volume-high-btn"),v_bar_bg_Len=v_bar_bg.offsetWidth;music_volumebar.addEventListener("mousedown",(function(e){v_bar_bg.style.height="0.6rem",v_bar.style.backgroundColor="var(--dis-f-0)",v_low.style.color="var(--dis-f-0)",v_high.style.color="var(--dis-f-0)";let x=e.pageX;v_bar.style.width=0+e.offsetX+"px";let v_bar_Len=v_bar.offsetWidth;v_bar_bg_Len=v_bar_bg.offsetWidth;let newVolume=e.offsetX/v_bar_bg_Len;document.querySelector("meting-js").aplayer.volume(newVolume,!0),document.onmousemove=function(e){let diff=x-e.pageX,v_bar_Len_New=v_bar_Len-diff;v_bar_Len_New<0?v_bar_Len_New=0:v_bar_Len_New>v_bar_bg_Len&&(v_bar_Len_New=v_bar_bg_Len),v_bar.style.width=v_bar_Len_New+"px",newVolume=v_bar_Len_New/v_bar_bg_Len,document.querySelector("meting-js").aplayer.volume(newVolume,!0)}})),music_volumebar.addEventListener("touchstart",(function(e){v_bar_bg.style.height="0.6rem",v_bar.style.backgroundColor="var(--dis-f-0)",v_low.style.color="var(--dis-f-0)",v_high.style.color="var(--dis-f-0)";let x=e.targetTouches[0].pageX;v_bar.style.width=0+e.targetTouches[0].offsetX+"px";let v_bar_Len=v_bar.offsetWidth;v_bar_bg_Len=v_bar_bg.offsetWidth;let newVolume=e.targetTouches[0].offsetX/v_bar_bg_Len;document.querySelector("meting-js").aplayer.volume(newVolume,!0),document.ontouchmove=function(e){let diff=x-e.targetTouches[0].pageX,v_bar_Len_New=v_bar_Len-diff;v_bar_Len_New<0?v_bar_Len_New=0:v_bar_Len_New>v_bar_bg_Len&&(v_bar_Len_New=v_bar_bg_Len),v_bar.style.width=v_bar_Len_New+"px",newVolume=v_bar_Len_New/v_bar_bg_Len,document.querySelector("meting-js").aplayer.volume(newVolume,!0)}}));var music_progressbar=document.getElementById("music-progressbar"),p_bar_bg=document.getElementById("p_bar_bg"),p_bar=document.getElementById("p_bar"),p_low=document.getElementById("progress-low-btn"),p_high=document.getElementById("progress-high-btn"),p_bar_Len_New=0,p_bar_bg_Len=p_bar_bg.offsetWidth,ctrl_flag=1,mousemove_flag=1;music_progressbar.addEventListener("mousedown",(function(e){p_bar_bg.style.height="0.6rem",p_bar.style.backgroundColor="var(--dis-f-0)",p_low.style.color="var(--dis-f-0)",p_high.style.color="var(--dis-f-0)",ctrl_flag=0,global_music_flag=1;let x=e.pageX,p_bar_Len=p_bar.offsetWidth;p_bar_bg_Len=p_bar_bg.offsetWidth,document.onmousemove=function(e){let diff=x-e.pageX;mousemove_flag=0,(p_bar_Len_New=p_bar_Len-diff)<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.width=p_bar_Len_New+"px";let all_Time=document.querySelector("meting-js").aplayer.audio.duration,current_time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.getElementById("progress-low-btn").innerHTML=tools.secToTime(current_time)}})),music_progressbar.addEventListener("touchstart",(function(e){p_bar_bg.style.height="0.6rem",p_bar.style.backgroundColor="var(--dis-f-0)",p_low.style.color="var(--dis-f-0)",p_high.style.color="var(--dis-f-0)",ctrl_flag=0,global_music_flag=1;let x=e.targetTouches[0].pageX,p_bar_Len=p_bar.offsetWidth;p_bar_bg_Len=p_bar_bg.offsetWidth,document.ontouchmove=function(e){let diff=x-e.targetTouches[0].pageX;mousemove_flag=0,(p_bar_Len_New=p_bar_Len-diff)<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.width=p_bar_Len_New+"px";let all_Time=document.querySelector("meting-js").aplayer.audio.duration,current_time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.getElementById("progress-low-btn").innerHTML=tools.secToTime(current_time)}})),document.onmouseup=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let all_Time=document.querySelector("meting-js").aplayer.audio.duration,new_Time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.querySelector("meting-js").aplayer.seek(new_Time)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.onmousemove=null},document.ontouchend=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let all_Time=document.querySelector("meting-js").aplayer.audio.duration,new_Time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.querySelector("meting-js").aplayer.seek(new_Time)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.ontouchmove=null},whenDOMReady(),document.addEventListener("pjax:complete",whenDOMReady);