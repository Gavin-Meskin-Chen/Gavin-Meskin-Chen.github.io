document.addEventListener("DOMContentLoaded",()=>{console.log("第一次加载完成"),cardTimes(),asideNote(),cardRefreshTimes(),ctrl.toPageJump(),ctrl.getCurrentPage(),0!=document.documentElement.scrollTop&&document.getElementById("page-header").classList.add("is-top-bar")}),document.addEventListener("pjax:complete",()=>{console.log("pjax加载完成（切换页面）"),document.getElementById("page-name").innerText=document.title.split(" | 参星阁")[0],cardTimes(),asideNote(),cardRefreshTimes(),ctrl.toPageJump(),ctrl.getCurrentPage(),0!=document.documentElement.scrollTop&&document.getElementById("page-header").classList.add("is-top-bar"),categoriesBarActive(),musicState()});const marqueeContainer1=document.getElementById("console-music-title"),marqueeContent1=document.getElementById("console-music-title-text"),marqueeContainer2=document.getElementById("console-music-author"),marqueeContent2=document.getElementById("console-music-author-text");var ipAddress="";function percent(){let a=document.documentElement.scrollTop||window.pageYOffset,b=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,result=Math.round(a/b*100),btn;result<=99||(result=99),document.querySelector("#percent").innerHTML=result}function cardTimes(){year=now.getFullYear(),month=now.getMonth(),week=now.getDay(),date=now.getDate();var cardWidgetCalendar=document.getElementById("card-widget-calendar");if(cardWidgetCalendar){var year_flag=year%4==0&&year%100!=0||year%400==0;switch(week){case 0:weekStr="周日";break;case 1:weekStr="周一";break;case 2:weekStr="周二";break;case 3:weekStr="周三";break;case 4:weekStr="周四";break;case 5:weekStr="周五";break;case 6:weekStr="周六";break;default:console.log("异常情况")}switch(month){case 0:monthStr="一月",dates=31;break;case 1:monthStr="二月",dates=year_flag?29:28;break;case 2:monthStr="三月",dates=31;break;case 3:monthStr="四月",dates=30;break;case 4:monthStr="五月",dates=31;break;case 5:monthStr="六月",dates=30;break;case 6:monthStr="七月",dates=31;break;case 7:monthStr="八月",dates=31;break;case 8:monthStr="九月",dates=30;break;case 9:monthStr="十月",dates=31;break;case 10:monthStr="十一月",dates=30;break;case 11:monthStr="十二月",dates=31;break;default:console.log("异常情况")}var week_first=(week+8-date%7)%7,count_days="",count_flag=!1,ds,row_h=7-week_first,row_f,rows=0==(dates-row_h)%7?Math.floor((dates-row_h)/7)+1:Math.floor((dates-row_h)/7)+2,calendar=cardWidgetCalendar.querySelector("#calendar-main"),gap=cardWidgetCalendar.querySelector("#calendar-date");switch(rows){case 4:gap.style.marginBottom="";break;case 5:gap.style.marginBottom="1.2rem";break;case 6:gap.style.marginBottom="2.4rem";break;default:gap.style.marginBottom="2.4rem"}for(let r=0;r<rows;r++){null==calendar.querySelector(".calendar-r"+r)&&(calendar.innerHTML+="<div class='calendar-r"+r+"'></div>");for(let d=0;d<7;d++)0==r&&d==week_first&&(count_days=1,count_flag=!0),ds=count_days==date?" class='now'":"",null==calendar.querySelector(".calendar-r"+r+" .calendar-d"+d+" a")&&(calendar.querySelector(".calendar-r"+r).innerHTML+="<div class='calendar-d"+d+"'><a"+ds+">"+count_days+"</a></div>"),count_days>=dates&&(count_days="",count_flag=!1),count_flag&&(count_days+=1)}var lunar=chineseLunar.solarToLunar(new Date(year,month,date));animalYear=chineseLunar.format(lunar,"A"),ganzhiYear=chineseLunar.format(lunar,"T").slice(0,-1),lunarMon=chineseLunar.format(lunar,"M"),lunarDay=chineseLunar.format(lunar,"d"),asideTime=new Date("2023/01/01 00:00:00"),asideDay=(now-asideTime)/1e3/60/60/24,asideDayNum=Math.floor(asideDay);var asideWeekNum=week-asideDayNum%7>=0?Math.ceil(asideDayNum/7):Math.ceil(asideDayNum/7)+1;cardWidgetCalendar.querySelector("#calendar-month").innerHTML=monthStr,cardWidgetCalendar.querySelector("#calendar-week").innerHTML=weekStr,cardWidgetCalendar.querySelector("#calendar-date").innerHTML=date.toString().padStart(2,"0"),cardWidgetCalendar.querySelector("#calendar-animal").innerHTML=ganzhiYear+animalYear+"年",cardWidgetCalendar.querySelector("#calendar-lunar").innerHTML=lunarMon+lunarDay,cardWidgetCalendar.querySelector("#aside-time-left").innerHTML=year+"&nbsp;&nbsp;<a style='font-size:1.1rem;font-weight:bold;'>第</a>&nbsp;"+asideWeekNum+"&nbsp;<a style='font-size:1.1rem;font-weight:bold;'>周</a>"}}function asideNote(){var noteCard=document.querySelector(".card-widget.card-announcement"),noteArea=document.querySelector(".card-widget.card-announcement .announcement_content");if(date==dates)noteCard.style.display="",noteArea.innerHTML="<p align='center'>今天月末，做好总结</p>",set_notice.checked&&tools.showNote("今天月末，做好总结","warning",5);else if(1==date)noteCard.style.display="",noteArea.innerHTML="<p align='center'>今天月初，做好规划</p>",set_notice.checked&&tools.showNote("今天月初，做好规划","warning",5);else switch(lunarDay){case"十六":noteCard.style.display="",noteArea.innerHTML="<p align='center'>今晚月圆</p>",set_notice.checked&&tools.showNote("今晚月圆","success",5);break;default:noteCard.style.display="none"}}function musicState(){var music_state=document.querySelector("meting-js").aplayer.audio.paused,a=document.querySelector("#music-Switch i"),b=document.querySelector("#music-ctrl-btn-center i");music_state?(a.classList.remove("fa-pause"),a.classList.add("fa-play"),b.classList.remove("fa-pause"),b.classList.add("fa-play")):(a.classList.remove("fa-play"),a.classList.add("fa-pause"),b.classList.remove("fa-play"),b.classList.add("fa-pause"))}"paintWorklet"in CSS&&CSS.paintWorklet.addModule("https://cdn1.tianli0.top/gh/Gavin-Meskin-Chen/BlogData@main/paint.min.js"),window.onload=function(){var set_music=document.querySelector("#set-switch-music input"),mplayer=document.getElementById("mplayer");if(mplayer.style.display=set_music.checked?"":"none",set_music.addEventListener("change",()=>{mplayer.style.display=set_music.checked?"":"none"}),null!=localStorage.getItem("notice_state")&&(set_notice.checked="true"==localStorage.getItem("notice_state")),null!=localStorage.getItem("lrc_state")&&"true"==localStorage.getItem("lrc_state")&&document.getElementById("ircSwitchBtn").click(),null!=localStorage.getItem("system_theme_state")&&(set_sys_theme.checked="true"==localStorage.getItem("system_theme_state")),set_sys_theme.checked){const isDarkMode=window.matchMedia("(prefers-color-scheme: dark)").matches,isLightMode=window.matchMedia("(prefers-color-scheme: light)").matches;isLightMode?(activateLightMode(),document.querySelector("#set-theme-light input").checked=!0,saveToLocal.set("theme","light",2)):isDarkMode&&(activateDarkMode(),document.querySelector("#set-theme-dark input").checked=!0,saveToLocal.set("theme","dark",2)),colorSchemeQuery.addListener(ctrl.GlobalTheme)}null!=saveToLocal.get("theme")&&("light"==saveToLocal.get("theme")?document.querySelector("#set-theme-light input").checked=!0:document.querySelector("#set-theme-dark input").checked=!0),set_notice.checked&&tools.showNote("欢迎来到参星阁！","success",5),console.log("\n %cGC音频控制器 v1.3.2 参星阁出品%c https://gavin-chen.top \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),console.log(`Welcome to:\n%c参星阁:%c https://gavin-chen.top%c\nThis site has been running stably for %c${Math.round(((new Date).getTime()-new Date("2023/01/04 20:53:58").getTime())/864e5)} %c days`,"border:1px #888 solid;border-right:0;border-radius:5px 0 0 5px;padding: 5px 10px;color:white;background:#4976f5;margin:10px 0","border:1px #888 solid;border-left:0;border-radius:0 5px 5px 0;padding: 5px 10px;","","color:#4976f5","")},window.onscroll=percent,document.getElementById("page-name").innerText=document.title.split(" | 参星阁")[0];var tools={secToTime:function(s){isNaN(s)&&(s=0);var min=Math.floor(s/60),sec=Math.floor(s%60),t;return min.toString().padStart(2,"0")+":"+sec.toString().padStart(2,"0")},detectBrowser:function(){const userAgent=navigator.userAgent;let browserName,fullVersion,majorVersion;function getHard(str){let str1=str.substring(str.indexOf("("),str.indexOf(")"));return str1.substring(str1.lastIndexOf(";")+2,str1.length)}let hard=getHard(userAgent);return/Firefox[\/\s](\d+\.\d+\.\d+\.\d+)/.test(userAgent)?(browserName="Firefox",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):/Edge[\/\s](\d+\.\d+\.\d+\.\d+)/.test(userAgent)?(browserName="Edge (Chromium)",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):/Edg[\/\s](\d+\.\d+\.\d+\.\d+)/.test(userAgent)?(browserName="Edge",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):/OPR[\/\s](\d+\.\d+\.\d+\.\d+)/.test(userAgent)?(browserName="Opera",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):/Chrome[\/\s](\d+\.\d+\.\d+\.\d+)/.test(userAgent)?(browserName="Chrome",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):/Safari[\/\s](\d+\.\d+\.\d+\.\d+)/.test(userAgent)?(browserName="Safari",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):/MSIE (\d+\.\d+);/.test(userAgent)||/Trident[\/\s](\d+\.\d+)/.test(userAgent)?(browserName="Internet Explorer",fullVersion=RegExp.$1,majorVersion=parseInt(RegExp.$1,10)):(browserName="Unknown",fullVersion="Unknown",majorVersion=0),{name:browserName,version:fullVersion,majorVersion:majorVersion,hard:hard}},getOSInfo:function(){let osName="unknown",osVersion="unknown";return-1!=navigator.userAgent.indexOf("Windows")?(osName="Windows",-1!=navigator.userAgent.indexOf("Windows NT 10.0")?osVersion="10":-1!=navigator.userAgent.indexOf("Windows NT 6.3")?osVersion="8.1":-1!=navigator.userAgent.indexOf("Windows NT 6.2")?osVersion="8":-1!=navigator.userAgent.indexOf("Windows NT 6.1")?osVersion="7":-1!=navigator.userAgent.indexOf("Windows NT 6.0")?osVersion="Vista":-1!=navigator.userAgent.indexOf("Windows NT 5.1")?osVersion="XP":-1!=navigator.userAgent.indexOf("Windows NT 5.0")&&(osVersion="2000")):-1!=navigator.userAgent.indexOf("Mac OS X")?(osName="macOS",osVersion=navigator.userAgent.match(/Mac OS X\s([\d_]+)/)[1].replace(/_/g,".")):-1!=navigator.userAgent.indexOf("Linux; Android 11")?(osName="HarmonyOS",osVersion=2):-1!=navigator.userAgent.indexOf("Linux; Android 12")?(osName="HarmonyOS",osVersion=3):-1!=navigator.userAgent.indexOf("Linux")?osName="Linux":-1!=navigator.userAgent.indexOf("Android")?(osName="Android",osVersion=navigator.userAgent.match(/Android\s([\d.]+)/)[1]):-1!=navigator.userAgent.indexOf("iOS")&&(osName="iOS",osVersion=navigator.userAgent.match(/OS\s([\d_]+)/)[1].replace(/_/g,".")),`${osName} ${osVersion}`},getMemoryUsage:function(){const memory=performance.memory,totalMemory=memory.totalJSHeapSize/1048576,usedMemory=memory.usedJSHeapSize/1048576,memoryLimit=memory.jsHeapSizeLimit/1048576;return console.log(`Total memory: ${totalMemory.toFixed(2)} MB`),console.log(`Used memory: ${usedMemory.toFixed(2)} MB`),console.log(`Memory limit: ${memoryLimit.toFixed(2)} MB`),{totalM:totalMemory.toFixed(2),usedM:usedMemory.toFixed(2),limitM:memoryLimit.toFixed(2)}},getBatteryInfo:function(){"getBattery"in navigator&&navigator.getBattery().then((function(battery){return console.log("Battery level: "+100*battery.level+"%"),console.log("Battery state: "+battery.charging),{level:battery.level,state:battery.charging}}))},showNote:function(text,style,delay){new Vue({data:function(){this.$notify({title:"阁主令",message:text,position:"top-left",showClose:!0,customClass:"element-note-bg-"+style,type:style,duration:1e3*delay})}})},showMessage:function(text,style,delay){new Vue({data:function(){this.$message({message:text,showClose:!0,type:style,duration:1e3*delay})}})},randomColor:function(){var colors,n;return["rgba(0,150,255,.95)","rgba(0,255,150,.95)","rgba(255,150,0,.95)","rgba(255,0,150,.95)","rgba(150,255,0,.95)","rgba(150,0,255,.95)"][Math.floor(6*Math.random())]}},ctrl={GlobalTheme:function(e){console.log(`changed to ${e.matches?"dark":"light"} mode`),e.matches?(activateDarkMode(),document.querySelector("#set-theme-dark input").checked=!0,saveToLocal.set("theme","dark",2)):(activateLightMode(),document.querySelector("#set-theme-light input").checked=!0,saveToLocal.set("theme","light",2))},switchDarkMode:function(){const nowMode="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===nowMode?document.querySelector("#set-theme-dark").click():document.querySelector("#set-theme-light").click(),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid()},showConsole:function(){document.querySelector("#console-music-item-main").classList.add("item-show"),document.querySelector("#console").classList.add("show"),document.body.style.overflow="hidden",ctrl.initConsoleState()},hideConsole:function(){var items=document.querySelectorAll(".item-show");for(let i=0;i<items.length;i++)items[i].classList.remove("item-show");document.querySelector("#console").classList.remove("show"),document.body.style.overflow=""},consoleBackBtn:function(){var top_item=document.querySelectorAll(".item-show");if(1==top_item.length)switch(top_item[0].id){case"console-music-item-mini":break;case"console-music-item-main":ctrl.hideConsole();break;case"console-music-item-list":top_item[0].classList.remove("item-show"),document.getElementById("console-music-item-main").classList.add("item-show");break;case"console-songsheet-item-list":top_item[0].classList.remove("item-show"),document.getElementById("console-music-item-list").classList.add("item-show");break;default:console.log("异常情况")}else top_item[top_item.length-1].classList.remove("item-show")},ircShowHide:function(){var irc=document.querySelector(".aplayer > .aplayer-lrc-hide"),a=document.querySelector(".aplayer > .aplayer-lrc"),b=document.querySelector("#ircItem");a&&b&&(null===irc?(a.classList.add("aplayer-lrc-hide"),b.classList.remove("on"),localStorage.setItem("lrc_state",!1),set_notice.checked&&tools.showMessage("桌面歌词已关闭","success",2)):(a.classList.remove("aplayer-lrc-hide"),b.classList.add("on"),localStorage.setItem("lrc_state",!0),set_notice.checked&&tools.showMessage("桌面歌词已打开","success",2)))},hideAsideBtn:()=>{const $htmlDom=document.documentElement.classList;$htmlDom.contains("hide-aside")?(saveToLocal.set("aside-status","show",2),document.querySelector("#asideItem").classList.remove("on"),set_notice.checked&&tools.showMessage("侧边栏已启用","success",2)):(saveToLocal.set("aside-status","hide",2),document.querySelector("#asideItem").classList.add("on"),set_notice.checked&&tools.showMessage("侧边栏已隐藏","success",2)),$htmlDom.toggle("hide-aside")},settingsOpen:function(){alert("开发中...敬请期待！")},musicSwitch:function(){var music_state=document.querySelector("meting-js").aplayer.audio.paused,a=document.querySelector("#music-Switch i"),b=document.querySelector("#music-ctrl-btn-center i");music_state?(a.classList.remove("fa-play"),a.classList.add("fa-pause"),b.classList.remove("fa-play"),b.classList.add("fa-pause")):(a.classList.remove("fa-pause"),a.classList.add("fa-play"),b.classList.remove("fa-pause"),b.classList.add("fa-play")),document.querySelector("meting-js").aplayer.toggle()},musicForward:function(){document.querySelector("meting-js").aplayer.skipForward(),ctrl.getMusicInfo()},musicBackward:function(){document.querySelector("meting-js").aplayer.skipBack(),ctrl.getMusicInfo()},getMusicInfo:function(){var music_id=document.querySelector("meting-js").aplayer.list.index,music_cover=document.querySelector("meting-js").aplayer.list.audios[music_id].cover,music_author=document.querySelector("meting-js").aplayer.list.audios[music_id].author,music_title=document.querySelector("meting-js").aplayer.list.audios[music_id].title;document.getElementById("console-music-cover").innerHTML="<img src='"+music_cover+"' style='width:100%;height:100%;border-radius:0.5rem;'>",document.getElementById("console-music-title-text").innerHTML=music_title,document.getElementById("console-music-author-text").innerHTML=music_author,ctrl.marqueeMusicInfo()},refreshProgress:function(){var nowTime=document.querySelector("meting-js").aplayer.audio.currentTime;isNaN(nowTime)&&(nowTime=0);var nowTimeString=tools.secToTime(nowTime),allTime=document.querySelector("meting-js").aplayer.audio.duration;isNaN(allTime)&&(allTime=0);var allTimeString=tools.secToTime(allTime);document.getElementById("progress-low-btn").innerHTML=nowTimeString,document.getElementById("progress-high-btn").innerHTML=allTimeString,document.querySelector("#p_bar").style.width=document.querySelector("#p_bar_bg").offsetWidth*(nowTime/allTime)+"px"},importMusicList:function(){var audios=document.querySelector("meting-js").aplayer.list.audios,list_html;for(let i=0;i<audios.length;i++)list_html=document.getElementById("console-music-list").innerHTML,document.getElementById("console-music-list").innerHTML=list_html+"<li class='music-list-item'><div class='list-music-info1'><a class='list-music-id' data-pjax-state=''>"+(i+1)+"</a><a class='list-music-state' data-pjax-state=''><i class='iconfont icon-waveform'></i></a></div><div class='list-music-info2'><a class='list-music-title' data-pjax-state=''>"+audios[i].title+"</a><a class='list-music-author' data-pjax-state=''> - "+audios[i].author+"</a></div></li>"},changeMusicList:function(Music_id,Music_server){var ap=document.querySelector("meting-js").aplayer,music_list_url_str="https://metingjs.gavin-chen.top/api?server="+Music_server+"&type=playlist&id="+Music_id;ap.list.clear(),fetch(music_list_url_str).then(response=>response.json()).then(data=>{newSongsheetLen=data.length,console.log("本专辑有"+newSongsheetLen+"首歌曲"),ap.list.add(data)}).catch(error=>console.error(error))},JayMusicList:function(){var ap=document.querySelector("meting-js").aplayer;ap.list.clear(),ap.list.add(JaySongsheet)},marqueeMusicInfo:function(){if(marqueeContent1.offsetWidth>marqueeContainer1.offsetWidth){var speed=marqueeContent1.offsetWidth/marqueeContainer1.offsetWidth*6;marqueeContent1.style.animation="marquee-1 "+speed+"s linear infinite"}else marqueeContent1.style.animation="";if(marqueeContent2.offsetWidth>marqueeContainer2.offsetWidth){var speed=marqueeContent2.offsetWidth/marqueeContainer2.offsetWidth*6;marqueeContent2.style.animation="marquee-1 "+speed+"s linear infinite"}else marqueeContent2.style.animation=""},initConsoleState:function(){var irc=document.querySelector(".aplayer > .aplayer-lrc-hide"),aplayer=document.querySelector(".aplayer > .aplayer-lrc");null===irc&&null!=aplayer?document.querySelector("#ircItem").classList.add("on"):document.querySelector("#ircItem").classList.remove("on"),"hide"===saveToLocal.get("aside-status")?document.querySelector("#asideItem").classList.add("on"):document.querySelector("#asideItem").classList.remove("on");var console_musicBody=document.querySelector("#console .console-mainbox"),console_musicCover=document.getElementById("console-music-cover");console_musicCover.style.height=console_musicCover.offsetWidth+"px",console_musicBody.style.height=console_musicCover.offsetWidth+236+"px",ctrl.getMusicInfo();var nowVolume=document.querySelector("meting-js").aplayer.audio.volume;document.querySelector("#v_bar").style.width=document.querySelector("#v_bar_bg").offsetWidth*nowVolume+"px","light"==saveToLocal.get("theme")?document.querySelector("#set-theme-light input").checked=!0:document.querySelector("#set-theme-dark input").checked=!0},refreshThemeColor:function(){var cover=document.getElementById("page-header");if(cover){var apiUrl=cover.style.backgroundImage.slice(5,-2)+"?x-oss-process=image/average-hue";fetch(apiUrl).then(response=>response.json()).then(data=>{var mainColor="#"+data.RGB.slice(2);console.log("主色调为："+mainColor),document.documentElement.style.setProperty("--gavin-main-color",mainColor)}).catch(error=>console.error(error))}},sidebarItemsFold:()=>{let e=document.querySelectorAll("#sidebar-menus .menus_items .site-page.group");e&&e.forEach(t=>{t.addEventListener("click",()=>{e.forEach(e=>{e!=t&&e.classList.add("hide")})})})},toPageJump:()=>{let e=document.querySelector("#pagination input.toPageInput");e&&(e.addEventListener("input",()=>{let t=document.querySelectorAll(".page-number"),n=t[t.length-1].innerHTML;Number(e.value)>n&&(e.value=n),Number(e.value)<1&&(e.value="")}),e.addEventListener("keyup",t=>{"Enter"==t.key&&""!=e.value&&"0"!=e.value&&pjax.loadUrl("1"==e.value?"/":`/page/${e.value}/#content-inner`)}))},getCurrentPage:()=>{if(window.innerWidth<=768&&document.querySelector("#body-wrap.page.home")){var currentPage=document.querySelector(".pagination .page-number.current").innerHTML;if(currentPage){var toPage=document.querySelector(".pagination .toPageInput");toPage&&(toPage.placeholder="第 "+currentPage+" 页")}}},getLocationWeather:()=>{fetch("https://api.ipify.org?format=json").then(response=>response.json()).then(data=>{ipAddress=data.ip,console.log("IP 地址："+ipAddress),fetch("https://apis.cansin.top/weather?ip="+ipAddress+"&output=jsonp").then(response=>response.json()).then(data=>{console.log(data);var day0=data.weatherJson.daily[0],day1=data.weatherJson.daily[1],day2=data.weatherJson.daily[2],district=data.locationJson.result.ad_info.district,city=data.locationJson.result.ad_info.city,province=data.locationJson.result.ad_info.province}).catch(error=>{console.error("获取天气信息失败:",error)})}).catch(error=>{console.error("获取 IP 地址失败:",error)})}};function categoriesBarActive(){document.querySelector("#category-bar")&&$(".category-bar-item").removeClass("select");var urlinfo=window.location.pathname,pattern,patbool;if("/"==(urlinfo=decodeURIComponent(urlinfo)))document.querySelector("#category-bar")&&document.getElementById("首页").classList.add("select");else if(/\/categories\/.*?\//.test(urlinfo)){var valuegroup,nowCategorie=urlinfo.split("/")[2];document.querySelector("#category-bar")&&document.getElementById(nowCategorie).classList.add("select")}}function tagsBarActive(){var urlinfo=window.location.pathname,pattern,patbool;if("/"==(urlinfo=decodeURIComponent(urlinfo)))document.querySelector("#tags-bar")&&document.getElementById("首页").classList.add("select");else if(/\/tags\/.*?\//.test(urlinfo)){var valuegroup,nowTag=urlinfo.split("/")[2];document.querySelector("#category-bar")&&document.getElementById(nowTag).classList.add("select")}}function topCategoriesBarScroll(){if(document.getElementById("category-bar-items")){let xscroll=document.getElementById("category-bar-items");xscroll.addEventListener("mousewheel",(function(e){let v=-e.wheelDelta/2;xscroll.scrollLeft+=v,e.preventDefault()}),!1)}}categoriesBarActive(),topCategoriesBarScroll(),document.onkeydown=function(e){if(123==e.keyCode||e.ctrlKey&&e.shiftKey&&(74===e.keyCode||73===e.keyCode||67===e.keyCode)||e.ctrlKey&&85===e.keyCode)return tools.showNote("开发者模式已打开，请遵循GPL协议","warning",5)},document.addEventListener("copy",()=>{set_notice.checked&&tools.showMessage("复制成功！转载请注明来源！","success",2)});var set_notice=document.querySelector("#set-switch-notice input");set_notice.addEventListener("change",()=>{set_notice.checked?localStorage.setItem("notice_state",!0):localStorage.setItem("notice_state",!1)});var music_list_switch=document.getElementById("music-ctrl-btn-end"),music_list_title=document.getElementById("music-list-title"),settings_btn=document.querySelector("#console .settings-btn"),to_display=document.querySelector("#li-set-display .setting-next"),to_about=document.querySelector("#li-set-about .setting-next"),setting_info1=document.getElementById("console-setting-info1"),setting_title1=document.querySelector("#console-setting-info1 .setting-title"),setting_info2=document.getElementById("console-setting-info2"),setting_title2=document.querySelector("#console-setting-info2 .setting-title");music_list_switch.addEventListener("click",()=>{document.getElementById("console-music-item-main").classList.remove("item-show"),document.getElementById("console-music-item-list").classList.add("item-show")}),music_list_title.addEventListener("click",()=>{document.getElementById("console-music-item-list").classList.remove("item-show"),document.getElementById("console-songsheet-item-list").classList.add("item-show")}),settings_btn.addEventListener("click",()=>{document.getElementById("console-settings").classList.add("item-show")}),to_display.addEventListener("click",()=>{setting_title1.innerHTML="显示和文本",setting_info1.classList.add("item-show")}),to_about.addEventListener("click",()=>{setting_title2.innerHTML="关于本机",document.querySelector("#console-setting-info2 .set-box-normal:nth-child(3) .setting-detail").innerHTML=tools.detectBrowser().hard,document.querySelector("#console-setting-info2 .set-box-normal:nth-child(4) .setting-detail").innerHTML=tools.getOSInfo(),document.querySelector("#console-setting-info2 .set-box-normal:nth-child(5) .setting-detail").innerHTML=tools.detectBrowser().name+" "+tools.detectBrowser().version,setting_info2.classList.add("item-show")}),document.getElementById("set-theme-light").addEventListener("click",()=>{document.querySelector("#set-theme-light input").checked=!0,activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid(),set_notice.checked&&tools.showMessage("已切换至浅色模式","success",2)}),document.getElementById("set-theme-dark").addEventListener("click",()=>{document.querySelector("#set-theme-dark input").checked=!0,activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid(),set_notice.checked&&tools.showMessage("已切换至深色模式","success",2)});var set_sys_theme=document.querySelector("#set-switch-systheme input");set_sys_theme.addEventListener("change",()=>{if(set_sys_theme.checked){localStorage.setItem("system_theme_state",!0);const isDarkMode=window.matchMedia("(prefers-color-scheme: dark)").matches,isLightMode=window.matchMedia("(prefers-color-scheme: light)").matches;isLightMode?(activateLightMode(),document.querySelector("#set-theme-light input").checked=!0,saveToLocal.set("theme","light",2)):isDarkMode&&(activateDarkMode(),document.querySelector("#set-theme-dark input").checked=!0,saveToLocal.set("theme","dark",2)),colorSchemeQuery.addListener(ctrl.GlobalTheme)}else localStorage.setItem("system_theme_state",!1),colorSchemeQuery.removeListener(ctrl.GlobalTheme)});var set_font_size=document.querySelector("#set-font-size input");set_font_size.addEventListener("change",()=>{document.documentElement.style.setProperty("--global-font-size",set_font_size.value+"px")});var songsheet0=document.getElementById("songsheet-X"),songsheet1=document.getElementById("songsheet-A"),songsheet2=document.getElementById("songsheet-B"),songsheet3=document.getElementById("songsheet-C"),songsheet4=document.getElementById("songsheet-D"),addSongsheet=document.getElementById("songsheet-add");songsheet0.addEventListener("click",()=>{document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至默认专辑"),global_music_flag=1,ctrl.changeMusicList("8086610771","netease"),document.getElementById("music-list-title").innerHTML="网易云"}),songsheet1.addEventListener("click",()=>{document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至纯音乐专辑"),global_music_flag=1,ctrl.changeMusicList("8167030216","netease"),document.getElementById("music-list-title").innerHTML="纯音乐"}),songsheet2.addEventListener("click",()=>{document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至周杰伦专辑"),global_music_flag=1,ctrl.JayMusicList(),document.getElementById("music-list-title").innerHTML="周杰伦"}),songsheet3.addEventListener("click",()=>{document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至薛之谦/李荣浩专辑"),global_music_flag=1,ctrl.changeMusicList("8163994837","netease"),document.getElementById("music-list-title").innerHTML="薛之谦/李荣浩"}),songsheet4.addEventListener("click",()=>{document.getElementById("console-loading-icon").classList.add("show"),console.log("正在切换至古风专辑"),global_music_flag=1,ctrl.changeMusicList("8167066222","netease"),document.getElementById("music-list-title").innerHTML="古风"}),addSongsheet.addEventListener("click",()=>{console.log("自定义专辑"),set_notice.checked&&tools.showNote("有空再写吧","warning",3)});var console_music_list=document.getElementById("console-music-list"),music_id=null;console_music_list.addEventListener("click",(function(e){var ap=document.querySelector("meting-js").aplayer;e.target&&"LI"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play(),ctrl.getMusicInfo()):e.target&&"DIV"==e.target.nodeName.toUpperCase()?(music_id=parseInt(e.target.parentElement.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play(),ctrl.getMusicInfo()):!e.target||"A"!=e.target.nodeName.toUpperCase()&&"I"!=e.target.nodeName.toUpperCase()?alert("ERROR!"):(music_id=parseInt(e.target.parentElement.parentElement.querySelector(".list-music-id").innerHTML),ap.list.switch(music_id-1),ap.play(),ctrl.getMusicInfo())}),!1);var music_volumebar=document.getElementById("music-volumebar"),v_bar_bg=document.getElementById("v_bar_bg"),v_bar=document.getElementById("v_bar"),v_low=document.getElementById("volume-low-btn"),v_high=document.getElementById("volume-high-btn"),v_bar_bg_Len=v_bar_bg.offsetWidth;music_volumebar.addEventListener("mousedown",(function(e){v_bar_bg.style.height="0.8rem",v_bar.style.backgroundColor="var(--dis-f-0)",v_low.style.color="var(--dis-f-0)",v_high.style.color="var(--dis-f-0)";let x=e.pageX;v_bar.style.width=0+e.offsetX+"px";let v_bar_Len=v_bar.offsetWidth;v_bar_bg_Len=v_bar_bg.offsetWidth;let newVolume=e.offsetX/v_bar_bg_Len;document.querySelector("meting-js").aplayer.volume(newVolume,!0),document.onmousemove=function(e){let diff=x-e.pageX,v_bar_Len_New=v_bar_Len-diff;v_bar_Len_New<0?v_bar_Len_New=0:v_bar_Len_New>v_bar_bg_Len&&(v_bar_Len_New=v_bar_bg_Len),v_bar.style.width=v_bar_Len_New+"px",newVolume=v_bar_Len_New/v_bar_bg_Len,document.querySelector("meting-js").aplayer.volume(newVolume,!0)}})),music_volumebar.addEventListener("touchstart",(function(e){v_bar_bg.style.height="0.8rem",v_bar.style.backgroundColor="var(--dis-f-0)",v_low.style.color="var(--dis-f-0)",v_high.style.color="var(--dis-f-0)";let x=e.targetTouches[0].pageX;v_bar.style.width=0+e.targetTouches[0].offsetX+"px";let v_bar_Len=v_bar.offsetWidth;v_bar_bg_Len=v_bar_bg.offsetWidth;let newVolume=e.targetTouches[0].offsetX/v_bar_bg_Len;document.querySelector("meting-js").aplayer.volume(newVolume,!0),document.ontouchmove=function(e){let diff=x-e.targetTouches[0].pageX,v_bar_Len_New=v_bar_Len-diff;v_bar_Len_New<0?v_bar_Len_New=0:v_bar_Len_New>v_bar_bg_Len&&(v_bar_Len_New=v_bar_bg_Len),v_bar.style.width=v_bar_Len_New+"px",newVolume=v_bar_Len_New/v_bar_bg_Len,document.querySelector("meting-js").aplayer.volume(newVolume,!0)}}));var music_progressbar=document.getElementById("music-progressbar"),p_bar_bg=document.getElementById("p_bar_bg"),p_bar=document.getElementById("p_bar"),p_low=document.getElementById("progress-low-btn"),p_high=document.getElementById("progress-high-btn"),p_bar_Len_New=0,p_bar_bg_Len=p_bar_bg.offsetWidth,ctrl_flag=1,mousemove_flag=1;music_progressbar.addEventListener("mousedown",(function(e){p_bar_bg.style.height="0.8rem",p_bar.style.backgroundColor="var(--dis-f-0)",p_low.style.color="var(--dis-f-0)",p_high.style.color="var(--dis-f-0)",ctrl_flag=0,global_music_flag=1;let x=e.pageX,p_bar_Len=p_bar.offsetWidth;p_bar_bg_Len=p_bar_bg.offsetWidth,document.onmousemove=function(e){let diff=x-e.pageX;mousemove_flag=0,(p_bar_Len_New=p_bar_Len-diff)<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.width=p_bar_Len_New+"px";let all_Time=document.querySelector("meting-js").aplayer.audio.duration,current_time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.getElementById("progress-low-btn").innerHTML=tools.secToTime(current_time)}})),music_progressbar.addEventListener("touchstart",(function(e){p_bar_bg.style.height="0.8rem",p_bar.style.backgroundColor="var(--dis-f-0)",p_low.style.color="var(--dis-f-0)",p_high.style.color="var(--dis-f-0)",ctrl_flag=0,global_music_flag=1;let x=e.targetTouches[0].pageX,p_bar_Len=p_bar.offsetWidth;p_bar_bg_Len=p_bar_bg.offsetWidth,document.ontouchmove=function(e){let diff=x-e.targetTouches[0].pageX;mousemove_flag=0,(p_bar_Len_New=p_bar_Len-diff)<0?p_bar_Len_New=0:p_bar_Len_New>p_bar_bg_Len&&(p_bar_Len_New=p_bar_bg_Len),p_bar.style.width=p_bar_Len_New+"px";let all_Time=document.querySelector("meting-js").aplayer.audio.duration,current_time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.getElementById("progress-low-btn").innerHTML=tools.secToTime(current_time)}})),document.onmouseup=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let all_Time=document.querySelector("meting-js").aplayer.audio.duration,new_Time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.querySelector("meting-js").aplayer.seek(new_Time)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.onmousemove=null},document.ontouchend=function(){if(v_bar_bg.style.height="0.4rem",v_bar.style.backgroundColor="var(--font-color)",v_low.style.color="var(--font-color)",v_high.style.color="var(--font-color)",p_bar_bg.style.height="0.4rem",p_bar.style.backgroundColor="var(--font-color)",p_low.style.color="var(--font-color)",p_high.style.color="var(--font-color)",0==ctrl_flag&&0==mousemove_flag){let all_Time=document.querySelector("meting-js").aplayer.audio.duration,new_Time=p_bar_Len_New/p_bar_bg_Len*all_Time;document.querySelector("meting-js").aplayer.seek(new_Time)}global_music_flag=0,ctrl_flag=1,mousemove_flag=1,document.ontouchmove=null};