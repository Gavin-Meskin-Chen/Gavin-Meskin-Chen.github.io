var _type=document.querySelector(".encryption .select-item.type"),_code=document.querySelector(".encryption .select-item.code"),_case=document.querySelector(".encryption .select-item.case"),_mode=document.querySelector(".encryption .select-item.mode"),_pad=document.querySelector(".encryption .select-item.pad"),_key=document.querySelector(".encryption .select-item.key"),_iv=document.querySelector(".encryption .select-item.iv"),textIn=document.querySelector(".encryption .inner"),textOut=document.querySelector(".encryption .outer");function copyTranscode(){textOut.select(),document.execCommand("copy")}function clearTranscode(){document.querySelector(".encryption .inner").value="",textOut.value="",textOut.disabled=!0,textOut.classList.add("lock")}function transcode(){var a="",b="",__mode="",__pad="",__text="",__key=CryptoJS.enc.Utf8.parse(_key.value),__iv=CryptoJS.enc.Utf8.parse(_iv.value);switch(_mode.value){case"CBC":__mode=CryptoJS.mode.CBC;break;case"CFB":__mode=CryptoJS.mode.CFB;break;case"CTR":__mode=CryptoJS.mode.CTR;break;case"OFB":__mode=CryptoJS.mode.OFB;break;case"ECB":__mode=CryptoJS.mode.ECB;break;default:__mode=CryptoJS.mode.CBC}switch(_pad.value){case"Pkcs7":__pad=CryptoJS.pad.Pkcs7;break;case"Iso97971":__pad=CryptoJS.pad.Iso97971;break;case"Iso10126":__pad=CryptoJS.pad.Iso10126;break;case"AnsiX923":__pad=CryptoJS.pad.AnsiX923;break;case"ZeroPadding":__pad=CryptoJS.pad.ZeroPadding;break;case"NoPadding":__pad=CryptoJS.pad.NoPadding;break;default:__pad=CryptoJS.pad.Pkcs7}switch(_type.value){case"MD5":a=CryptoJS.MD5(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"SHA1":a=CryptoJS.SHA1(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"SHA3":a=CryptoJS.SHA3(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"SHA224":a=CryptoJS.SHA224(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"SHA256":a=CryptoJS.SHA256(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"SHA384":a=CryptoJS.SHA384(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"SHA512":a=CryptoJS.SHA512(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"RIPEMD160":a=CryptoJS.RIPEMD160(textIn.value),b="Hex"==_code.value?a.toString():CryptoJS.enc.Base64.stringify(a),textOut.value="Lower"==_case.value?b:b.toUpperCase();break;case"AESEncode":__text=CryptoJS.enc.Utf8.parse(textIn.value),a=CryptoJS.AES.encrypt(__text,__key,{iv:__iv,mode:__mode,padding:__pad}),b="Hex"==_code.value?CryptoJS.enc.Hex.stringify(a.ciphertext):a.toString(),textOut.value=b;break;case"AESDecode":var base64Regex,hexRegex=/^(?:[0-9a-fA-F]{4})*$/;if(/^[A-Za-z0-9+/]*={1,2}$/.test(textIn.value)){console.log("base64"),__text=CryptoJS.enc.Base64.stringify(CryptoJS.enc.Base64.parse(textIn.value)),textOut.value=CryptoJS.AES.decrypt(__text,__key,{iv:__iv,mode:__mode,padding:__pad}).toString(CryptoJS.enc.Utf8);break}if(hexRegex.test(textIn.value)){console.log("hex"),__text=CryptoJS.enc.Hex.parse(textIn.value),textOut.value=CryptoJS.AES.decrypt({ciphertext:__text},__key,{iv:__iv,mode:__mode,padding:__pad}).toString(CryptoJS.enc.Utf8);break}console.log("数据错误"),alert("数据错误")}textOut.disabled=!1,textOut.classList.remove("lock")}textOut.addEventListener("input",()=>{""==textOut.value?(textOut.disabled=!0,textOut.classList.add("lock")):(textOut.disabled=!1,textOut.classList.remove("lock"))}),_type.addEventListener("change",()=>{"AESEncode"==_type.value?(_case.classList.add("hide"),_code.classList.remove("hide"),_mode.classList.remove("hide"),_pad.classList.remove("hide"),_key.classList.remove("hide"),_iv.classList.remove("hide")):"AESDecode"==_type.value?(_code.classList.add("hide"),_case.classList.add("hide"),_mode.classList.remove("hide"),_pad.classList.remove("hide"),_key.classList.remove("hide"),_iv.classList.remove("hide")):(_code.classList.remove("hide"),_case.classList.remove("hide"),_mode.classList.add("hide"),_pad.classList.add("hide"),_key.classList.add("hide"),_iv.classList.add("hide"))}),_mode.addEventListener("change",()=>{"ECB"!=_mode.value?_iv.classList.contains("lock")&&(_iv.classList.remove("lock"),_iv.disabled=!1):_iv.classList.contains("lock")||(_iv.classList.add("lock"),_iv.disabled=!0)});