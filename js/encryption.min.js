function copyTranscode(){textOut.select(),document.execCommand("copy")}function clearTranscode(){document.querySelector(".encryption .inner").value="",textOut.value="",textOut.disabled=!0,textOut.classList.add("lock")}function transcode(){var e="",t="",a="",o="",s="",c=CryptoJS.enc.Utf8.parse(_key.value),r=CryptoJS.enc.Utf8.parse(_iv.value);switch(_mode.value){case"CBC":a=CryptoJS.mode.CBC;break;case"CFB":a=CryptoJS.mode.CFB;break;case"CTR":a=CryptoJS.mode.CTR;break;case"OFB":a=CryptoJS.mode.OFB;break;case"ECB":a=CryptoJS.mode.ECB;break;default:a=CryptoJS.mode.CBC}switch(_pad.value){case"Pkcs7":o=CryptoJS.pad.Pkcs7;break;case"Iso97971":o=CryptoJS.pad.Iso97971;break;case"Iso10126":o=CryptoJS.pad.Iso10126;break;case"AnsiX923":o=CryptoJS.pad.AnsiX923;break;case"ZeroPadding":o=CryptoJS.pad.ZeroPadding;break;case"NoPadding":o=CryptoJS.pad.NoPadding;break;default:o=CryptoJS.pad.Pkcs7}switch(_type.value){case"MD5":e=CryptoJS.MD5(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"SHA1":e=CryptoJS.SHA1(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"SHA3":e=CryptoJS.SHA3(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"SHA224":e=CryptoJS.SHA224(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"SHA256":e=CryptoJS.SHA256(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"SHA384":e=CryptoJS.SHA384(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"SHA512":e=CryptoJS.SHA512(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"RIPEMD160":e=CryptoJS.RIPEMD160(textIn.value),t="Hex"==_code.value?e.toString():CryptoJS.enc.Base64.stringify(e),textOut.value="Lower"==_case.value?t:t.toUpperCase();break;case"AESEncode":s=CryptoJS.enc.Utf8.parse(textIn.value),e=CryptoJS.AES.encrypt(s,c,{iv:r,mode:a,padding:o}),t="Hex"==_code.value?CryptoJS.enc.Hex.stringify(e.ciphertext):e.toString(),textOut.value=t;break;case"AESDecode":var i=/^[A-Za-z0-9+/]*={1,2}$/,d=/^(?:[0-9a-fA-F]{4})*$/;if(i.test(textIn.value)){console.log("base64"),s=CryptoJS.enc.Base64.stringify(CryptoJS.enc.Base64.parse(textIn.value)),textOut.value=CryptoJS.AES.decrypt(s,c,{iv:r,mode:a,padding:o}).toString(CryptoJS.enc.Utf8);break}if(d.test(textIn.value)){console.log("hex"),s=CryptoJS.enc.Hex.parse(textIn.value),textOut.value=CryptoJS.AES.decrypt({ciphertext:s},c,{iv:r,mode:a,padding:o}).toString(CryptoJS.enc.Utf8);break}console.log("数据错误"),alert("数据错误")}textOut.disabled=!1,textOut.classList.remove("lock")}var _type=document.querySelector(".encryption .select-item.type"),_code=document.querySelector(".encryption .select-item.code"),_case=document.querySelector(".encryption .select-item.case"),_mode=document.querySelector(".encryption .select-item.mode"),_pad=document.querySelector(".encryption .select-item.pad"),_key=document.querySelector(".encryption .select-item.key"),_iv=document.querySelector(".encryption .select-item.iv"),textIn=document.querySelector(".encryption .inner"),textOut=document.querySelector(".encryption .outer");textOut.addEventListener("input",()=>{""==textOut.value?(textOut.disabled=!0,textOut.classList.add("lock")):(textOut.disabled=!1,textOut.classList.remove("lock"))}),_type.addEventListener("change",()=>{"AESEncode"==_type.value?(_case.classList.add("hide"),_code.classList.remove("hide"),_mode.classList.remove("hide"),_pad.classList.remove("hide"),_key.classList.remove("hide"),_iv.classList.remove("hide")):"AESDecode"==_type.value?(_code.classList.add("hide"),_case.classList.add("hide"),_mode.classList.remove("hide"),_pad.classList.remove("hide"),_key.classList.remove("hide"),_iv.classList.remove("hide")):(_code.classList.remove("hide"),_case.classList.remove("hide"),_mode.classList.add("hide"),_pad.classList.add("hide"),_key.classList.add("hide"),_iv.classList.add("hide"))}),_mode.addEventListener("change",()=>{"ECB"!=_mode.value?_iv.classList.contains("lock")&&(_iv.classList.remove("lock"),_iv.disabled=!1):_iv.classList.contains("lock")||(_iv.classList.add("lock"),_iv.disabled=!0)});